<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marcelo Araya-Salas, PhD">
<meta name="dcterms.date" content="2023-07-19">

<title>Geographic call variation in yellow-naped amazon across its entire geographic range</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="data_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="data_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="data_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="data_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="data_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="data_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="data_analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="data_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="data_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="data_analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="qmd.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link active" data-scroll-target="#data-analysis"><span class="toc-section-number">1</span>  Data analysis</a>
  <ul class="collapse">
  <li><a href="#read-data" id="toc-read-data" class="nav-link" data-scroll-target="#read-data"><span class="toc-section-number">1.1</span>  Read data</a></li>
  <li><a href="#compute-geographic-distance" id="toc-compute-geographic-distance" class="nav-link" data-scroll-target="#compute-geographic-distance"><span class="toc-section-number">1.2</span>  Compute geographic distance</a></li>
  <li><a href="#mantel-correlogram" id="toc-mantel-correlogram" class="nav-link" data-scroll-target="#mantel-correlogram"><span class="toc-section-number">1.3</span>  Mantel correlogram</a></li>
  </ul></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation"><span class="toc-section-number">2</span>  Simulation</a>
  <ul class="collapse">
  <li><a href="#simulate-data-with-different-patterns-of-geographic-variation-in-call-structure" id="toc-simulate-data-with-different-patterns-of-geographic-variation-in-call-structure" class="nav-link" data-scroll-target="#simulate-data-with-different-patterns-of-geographic-variation-in-call-structure"><span class="toc-section-number">2.1</span>  Simulate data with different patterns of geographic variation in call structure</a></li>
  <li><a href="#simulate-acoustic-variation" id="toc-simulate-acoustic-variation" class="nav-link" data-scroll-target="#simulate-acoustic-variation"><span class="toc-section-number">2.2</span>  Simulate acoustic variation:</a></li>
  <li><a href="#stats-on-simulated-data" id="toc-stats-on-simulated-data" class="nav-link" data-scroll-target="#stats-on-simulated-data"><span class="toc-section-number">2.3</span>  Stats on simulated data</a></li>
  <li><a href="#replicate-simulation-100-times" id="toc-replicate-simulation-100-times" class="nav-link" data-scroll-target="#replicate-simulation-100-times"><span class="toc-section-number">2.4</span>  Replicate simulation 100 times</a></li>
  </ul></li>
  <li><a href="#real-data-analysis" id="toc-real-data-analysis" class="nav-link" data-scroll-target="#real-data-analysis"><span class="toc-section-number">3</span>  Real data analysis</a>
  <ul class="collapse">
  <li><a href="#association-between-distance-call-similarity-geographic-distance-and-dialect-membership" id="toc-association-between-distance-call-similarity-geographic-distance-and-dialect-membership" class="nav-link" data-scroll-target="#association-between-distance-call-similarity-geographic-distance-and-dialect-membership"><span class="toc-section-number">3.1</span>  Association between distance call similarity, geographic distance and dialect membership</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Geographic call variation in yellow-naped amazon across its entire geographic range</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Statistical analysis</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="http://marceloarayasalas.weebly.com/">Marcelo Araya-Salas, PhD</a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 19, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<!-- this code add line numbers to code blocks -->
<!-- only works when code folding is not used in yaml (code_folding: show) -->
<style>
body
  { counter-reset: source-line 0; }
pre.numberSource code
  { counter-reset: none; }
</style>
<div class="cell">

</div>
<p>Source code and data found at <a href="https://github.com/maRce10/geographic_call_variation_yellow-naped_amazon">https://github.com/maRce10/geographic_call_variation_yellow-naped_amazon</a></p>
<div class="cell">

</div>
<!-- skyblue box -->
<section id="purpose" class="level1 unnumbered unlisted alert alert-info">
<h1 class="unnumbered unlisted">Purpose</h1>
<ul>
<li>Evaluate call structure variation and ist relation to the geographic distanc</li>
</ul>
</section>
<p>&nbsp;</p>
<section id="load-packages" class="level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">Load packages</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># knitr is require for creating html/pdf/word reports formatR is</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># used for soft-wrapping code</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># install/ load packages</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>sketchy<span class="sc">::</span><span class="fu">load_packages</span>(<span class="at">packages =</span> <span class="fu">c</span>(<span class="st">"knitr"</span>, <span class="st">"formatR"</span>, <span class="st">"rprojroot"</span>,</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="st">"sp"</span>, <span class="st">"rgdal"</span>, <span class="st">"rgeos"</span>, <span class="st">"dplyr"</span>, <span class="st">"raster"</span>, <span class="st">"dplyr"</span>, <span class="st">"spData"</span>,</span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="st">"vegan"</span>, <span class="st">"ggplot2"</span>, <span class="st">"pbapply"</span>, <span class="st">"viridis"</span>, <span class="st">"caret"</span>, <span class="at">github =</span> <span class="st">"PhenotypeSpace"</span>,</span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="st">"brms"</span>, <span class="at">github =</span> <span class="st">"brmsish"</span>, <span class="st">"ecodist"</span>))</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">source</span>(<span class="st">"./scripts/MRM2.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-analysis" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Data analysis</h1>
<section id="read-data" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="read-data"><span class="header-section-number">1.1</span> Read data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Read in and convert the dataframe to Spatial Points object.</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>sels <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/raw/ReducedVocalDataYNA.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a>sels<span class="sc">$</span>Latitude <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sels<span class="sc">$</span>Latitude)</span>
<span id="cb2-5"><a href="#cb2-5"></a>sels<span class="sc">$</span>Longitude <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sels<span class="sc">$</span>Longitude)</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a>sels<span class="sc">$</span>Latitude <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(sels<span class="sc">$</span>Latitude)</span>
<span id="cb2-8"><a href="#cb2-8"></a>sels<span class="sc">$</span>Longitude <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(sels<span class="sc">$</span>Longitude)</span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a>sels <span class="ot">&lt;-</span> sels[<span class="fu">order</span>(sels<span class="sc">$</span>Call_Type), ]</span>
<span id="cb2-11"><a href="#cb2-11"></a></span>
<span id="cb2-12"><a href="#cb2-12"></a>sels<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(sels)) sels<span class="sc">$</span>id[i] <span class="ot">&lt;-</span> <span class="cf">if</span> (sels<span class="sc">$</span>Call_Type[i] <span class="sc">==</span> sels<span class="sc">$</span>Call_Type[i <span class="sc">-</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>    <span class="dv">1</span>]) sels<span class="sc">$</span>id[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb2-15"><a href="#cb2-15"></a></span>
<span id="cb2-16"><a href="#cb2-16"></a>sels<span class="sc">$</span>selsID <span class="ot">&lt;-</span> <span class="fu">paste</span>(sels<span class="sc">$</span>Call_Type, sels<span class="sc">$</span>id, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a>xc <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/SPCC2016_2018_2019.RDS"</span>)</span>
<span id="cb2-19"><a href="#cb2-19"></a>xc <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(xc)</span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="fu">rownames</span>(xc) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(xc) <span class="ot">&lt;-</span> sels<span class="sc">$</span>selsID</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="compute-geographic-distance" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="compute-geographic-distance"><span class="header-section-number">1.2</span> Compute geographic distance</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># convert the dataframe to Spatial Points object.</span></span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>mat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lon =</span> sels<span class="sc">$</span>Longitude, <span class="at">lat =</span> sels<span class="sc">$</span>Latitude)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">str</span>(mat)</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a>sp_pts <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(mat, <span class="at">proj4string =</span> <span class="fu">CRS</span>(<span class="st">"+proj=longlat +ellps=GRS80 +no_defs +init:epsg31972"</span>))</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co"># Reproject using EPSG codes EPSG codes are specific to regions</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># across the world. Codes can be accessed at the following site:</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co"># http://epsg.io or by searching for other EPSG repositories</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co"># online.</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>epsg <span class="ot">&lt;-</span> rgdal<span class="sc">::</span><span class="fu">make_EPSG</span>()</span>
<span id="cb3-13"><a href="#cb3-13"></a>epsg[<span class="fu">grep</span>(<span class="st">"^31972$"</span>, epsg<span class="sc">$</span>code), ]</span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a>sp_pts <span class="ot">&lt;-</span> sp<span class="sc">::</span><span class="fu">spTransform</span>(sp_pts, <span class="at">CRSobj =</span> <span class="fu">CRS</span>(epsg<span class="sc">$</span>prj4[<span class="fu">grep</span>(<span class="st">"^31972$"</span>,</span>
<span id="cb3-16"><a href="#cb3-16"></a>    epsg<span class="sc">$</span>code)]))</span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="fu">bbox</span>(sp_pts)</span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="fu">proj4string</span>(sp_pts)</span>
<span id="cb3-19"><a href="#cb3-19"></a></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co"># Calculate the pairwise distances</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>geo_dists <span class="ot">&lt;-</span> rgeos<span class="sc">::</span><span class="fu">gDistance</span>(sp_pts, <span class="at">byid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-22"><a href="#cb3-22"></a></span>
<span id="cb3-23"><a href="#cb3-23"></a></span>
<span id="cb3-24"><a href="#cb3-24"></a></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="fu">rownames</span>(geo_dists) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(geo_dists) <span class="ot">&lt;-</span> sels<span class="sc">$</span>selsID</span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="fu">str</span>(geo_dists)</span>
<span id="cb3-27"><a href="#cb3-27"></a></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="fu">saveRDS</span>(geo_dists, <span class="st">"./data/processed/pairwise_distances.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mantel-correlogram" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="mantel-correlogram"><span class="header-section-number">1.3</span> Mantel correlogram</h2>
<p>Average interpolated distances from correlograms at 25, 50, 100, 150, 200 and 250 km</p>
<section id="compute-mantel-correlogram-at-different-distances" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="compute-mantel-correlogram-at-different-distances"><span class="header-section-number">1.3.1</span> Compute mantel correlogram at different distances</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>geo_dists <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/pairwise_distances.RDS"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># View('geo_dists')</span></span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># Projection is in meters, so we convert to km</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>geo_dists <span class="ot">&lt;-</span> <span class="fu">round</span>(geo_dists<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># When we plot our data, we want the points to be connected in</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co"># one continuous line. In order to achieve that, we identified</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co"># 'breaks' in distances using the following code. Break</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co"># intervals are measured in km, and once a break limit was</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co"># chosen we checked the number of existing 0's by creating a</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co"># table of the classes. If a 0 shows in one of the classes, that</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co"># class has no data and the break number should be altered.</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co"># Although not essential, minimizing zeros maintains continuity</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co"># in the plotted line for the graphic.</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>geo_vect <span class="ot">&lt;-</span> geo_dists[<span class="fu">lower.tri</span>(geo_dists)]</span>
<span id="cb4-17"><a href="#cb4-17"></a>geo_vect <span class="ot">&lt;-</span> geo_vect[geo_vect <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(geo_vect)]</span>
<span id="cb4-18"><a href="#cb4-18"></a></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co"># read cross-correlation data</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>xc <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/SPCC2016_2018_2019.RDS"</span>)</span>
<span id="cb4-21"><a href="#cb4-21"></a></span>
<span id="cb4-22"><a href="#cb4-22"></a>xc_dist <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> xc</span>
<span id="cb4-23"><a href="#cb4-23"></a></span>
<span id="cb4-24"><a href="#cb4-24"></a>dists <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">250</span>)</span>
<span id="cb4-25"><a href="#cb4-25"></a></span>
<span id="cb4-26"><a href="#cb4-26"></a>mantel_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(dists, <span class="at">cl =</span> <span class="dv">18</span>, <span class="cf">function</span>(i) {</span>
<span id="cb4-27"><a href="#cb4-27"></a></span>
<span id="cb4-28"><a href="#cb4-28"></a>    classes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(geo_dists), i)</span>
<span id="cb4-29"><a href="#cb4-29"></a>    <span class="co"># length(classes)</span></span>
<span id="cb4-30"><a href="#cb4-30"></a></span>
<span id="cb4-31"><a href="#cb4-31"></a>    <span class="co"># Run a mantel correlation on the data</span></span>
<span id="cb4-32"><a href="#cb4-32"></a>    correl_SPCC <span class="ot">&lt;-</span> vegan<span class="sc">::</span><span class="fu">mantel.correlog</span>(<span class="at">D.eco =</span> xc_dist, <span class="at">D.geo =</span> geo_dists,</span>
<span id="cb4-33"><a href="#cb4-33"></a>        <span class="at">break.pts =</span> classes, <span class="at">cutoff =</span> <span class="cn">FALSE</span>, <span class="at">r.type =</span> <span class="st">"pearson"</span>, <span class="at">nperm =</span> <span class="dv">1</span>,</span>
<span id="cb4-34"><a href="#cb4-34"></a>        <span class="at">mult =</span> <span class="st">"holm"</span>, <span class="at">progressive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-35"><a href="#cb4-35"></a></span>
<span id="cb4-36"><a href="#cb4-36"></a>    mantel.res <span class="ot">&lt;-</span> correl_SPCC<span class="sc">$</span>mantel.res[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb4-37"><a href="#cb4-37"></a>    mantel.res <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mantel.res, <span class="at">break.size =</span> i)</span>
<span id="cb4-38"><a href="#cb4-38"></a></span>
<span id="cb4-39"><a href="#cb4-39"></a>    <span class="fu">return</span>(mantel.res)</span>
<span id="cb4-40"><a href="#cb4-40"></a></span>
<span id="cb4-41"><a href="#cb4-41"></a>})</span>
<span id="cb4-42"><a href="#cb4-42"></a></span>
<span id="cb4-43"><a href="#cb4-43"></a>mantel_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(mantel_list, as.data.frame)</span>
<span id="cb4-44"><a href="#cb4-44"></a></span>
<span id="cb4-45"><a href="#cb4-45"></a><span class="co"># # Save the correlation as an .RDS file so you don't have to</span></span>
<span id="cb4-46"><a href="#cb4-46"></a><span class="co"># run it multiple times in the future</span></span>
<span id="cb4-47"><a href="#cb4-47"></a><span class="fu">saveRDS</span>(mantel_list, <span class="fu">paste0</span>(<span class="st">"./data/processed/correl_SPCC_several_distances.RDS"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-mean-correlogram" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="plot-mean-correlogram"><span class="header-section-number">1.3.2</span> Plot mean correlogram</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>mantel_list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(<span class="st">"./data/processed/correl_SPCC_several_distances.RDS"</span>))</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>mantels_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(rbind, mantel_list))</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>combined_dists <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(mantels_df<span class="sc">$</span>class.index))</span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co"># interpolate</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>interpol_mantel_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(mantel_list, <span class="cf">function</span>(x) {</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a>    appx <span class="ot">&lt;-</span> <span class="fu">approx</span>(<span class="at">x =</span> x<span class="sc">$</span>class.index[x<span class="sc">$</span>n.dist <span class="sc">&gt;</span> <span class="dv">0</span>], <span class="at">y =</span> x<span class="sc">$</span>Mantel.cor[x<span class="sc">$</span>n.dist <span class="sc">&gt;</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>        <span class="dv">0</span>], <span class="at">xout =</span> combined_dists, <span class="at">method =</span> <span class="st">"linear"</span>)</span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a>    <span class="fu">return</span>(appx<span class="sc">$</span>y)</span>
<span id="cb5-14"><a href="#cb5-14"></a>})</span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a></span>
<span id="cb5-17"><a href="#cb5-17"></a>interpol_mantel_mat <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, interpol_mantel_list)</span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a>interpol_mantel_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(combined_dists, <span class="at">mean.cor =</span> <span class="fu">apply</span>(interpol_mantel_mat,</span>
<span id="cb5-21"><a href="#cb5-21"></a>    <span class="dv">1</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">sd.cor =</span> <span class="fu">apply</span>(interpol_mantel_mat, <span class="dv">1</span>,</span>
<span id="cb5-22"><a href="#cb5-22"></a>    sd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb5-23"><a href="#cb5-23"></a></span>
<span id="cb5-24"><a href="#cb5-24"></a></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="fu">ggplot</span>(<span class="at">data =</span> interpol_mantel_df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> combined_dists,</span>
<span id="cb5-26"><a href="#cb5-26"></a>    <span class="at">y =</span> mean.cor)) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="at">data =</span> interpol_mantel_df, <span class="fu">aes</span>(<span class="at">ymin =</span> mean.cor <span class="sc">-</span></span>
<span id="cb5-27"><a href="#cb5-27"></a>    sd.cor, <span class="at">ymax =</span> mean.cor <span class="sc">+</span> sd.cor), <span class="at">fill =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb5-28"><a href="#cb5-28"></a>    <span class="fu">geom_point</span>(<span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)[<span class="dv">7</span>], <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">10</span>,</span>
<span id="cb5-29"><a href="#cb5-29"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>)[<span class="dv">7</span>], <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.025</span>,</span>
<span id="cb5-30"><a href="#cb5-30"></a>    <span class="fl">0.2</span>)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb5-31"><a href="#cb5-31"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Pairwise geographic distance (km)"</span>, <span class="at">y =</span> <span class="st">"Correlation coefficient"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">ggsave</span>(<span class="st">"./output/interpolated_mantel_correlogram.png"</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="simulation" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Simulation</h1>
<section id="simulate-data-with-different-patterns-of-geographic-variation-in-call-structure" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="simulate-data-with-different-patterns-of-geographic-variation-in-call-structure"><span class="header-section-number">2.1</span> Simulate data with different patterns of geographic variation in call structure</h2>
<ul>
<li>26 localities (10 individuals each) along a longitudinal range</li>
<li>Simulated patterns following <a href="https://d1wqtxts1xzle7.cloudfront.net/53993414/The_Evolution_of_Geographic_Variation_in20170727-7403-7je2az-libre.pdf?1501183774=&amp;response-content-disposition=inline%3B+filename%3DThe_Evolution_of_Geographic_Variation_in.pdf&amp;Expires=1689718560&amp;Signature=c9HxG2TqaqonkjDKlotzx1jrLJl25sX1V2Jj0DpDFTtDNsSi7ykNv~Ii4XFFe-yEh4fUF6HX0MYzT9ImbUJykmwIJXumf8VELyHp5tj5QYjR9FmpCftHXf1JdwBh-vCm2zaQ2VOh~iaHcMqTqjnDQR1W3FMQDU1dVeduLpkSma~8eLQ15e-SAHPYVwvSu-R1a2Q9KDibQyq84MbEFbLgbz9T3eBxZpsUAnxrGUrlHWo9CtbBEMtORbh9id4KG-RaAVyA38v4FtS8qofXX9zpcZNQILVGkhIwXeCbYkRVBbC9w5OieTVvIUQBXxEwZltgQ~ZWzbkzI1~wmHRnkbhYzQ__&amp;Key-Pair-Id=APKAJLOHF5GGSLRBV4ZA">Podos &amp; Warren (2007)</a></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="podos_warren_fig_3.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure from Podos &amp; Warren (2007)</figcaption><p></p>
</figure>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># seed to make it reproducible</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># number of groups</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>n_locality <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co"># number of individuals per group</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>n_indiv <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co"># simulate geographic coordinates along a gradient</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>lon <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_locality, <span class="at">each =</span> n_indiv) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span> n_locality,</span>
<span id="cb7-12"><a href="#cb7-12"></a>    <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb7-13"><a href="#cb7-13"></a>lat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span> n_locality, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb7-14"><a href="#cb7-14"></a></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co"># create locality labels</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>localities <span class="ot">&lt;-</span> <span class="fu">sample</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span>n_locality])</span>
<span id="cb7-17"><a href="#cb7-17"></a></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co"># put all together in a data frame</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">locality =</span> <span class="fu">rep</span>(localities, <span class="at">each =</span> n_indiv), lat,</span>
<span id="cb7-20"><a href="#cb7-20"></a>    lon, <span class="at">color =</span> <span class="fu">viridis</span>(n_locality)[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_locality, <span class="at">each =</span> n_indiv)])</span>
<span id="cb7-21"><a href="#cb7-21"></a></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co"># plot localities along longitude</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="fu">plot</span>(data[, <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>)], <span class="at">col =</span> data<span class="sc">$</span>color, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.8</span>,</span>
<span id="cb7-24"><a href="#cb7-24"></a>    <span class="at">ylim =</span> <span class="fu">range</span>(data<span class="sc">$</span>lat) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>))</span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">tapply</span>(data<span class="sc">$</span>lon, data<span class="sc">$</span>locality, mean), <span class="at">y =</span> <span class="fu">rep</span>(<span class="fl">0.3</span>, n_locality),</span>
<span id="cb7-26"><a href="#cb7-26"></a>    <span class="at">labels =</span> localities, <span class="at">cex =</span> <span class="fl">2.5</span>)</span>
<span id="cb7-27"><a href="#cb7-27"></a></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span> <span class="sc">-</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Geographic location of individuals/localities in the simulated data set. Letters highlight locality ids</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="simulate-acoustic-variation" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="simulate-acoustic-variation"><span class="header-section-number">2.2</span> Simulate acoustic variation:</h2>
<ul>
<li>Clinal: acoustic structure vector increases with longitude</li>
<li>Dialect-type: acoustic structure vector similar within a locality but varies randomly between neighnoring localities</li>
<li>Dialect-clinal: Combined clinal and dialect variation, dialect that vary with a geographic trend</li>
<li>Random: acoustic structure vector varies randomly between individuals regardless of locality or longitude</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># seed to make it reproducible</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># simulate acoustic structure vector clinal variation</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>data<span class="sc">$</span>clinal <span class="ot">&lt;-</span> data<span class="sc">$</span>lon <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(data), <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co"># dialect type variation</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>data<span class="sc">$</span>dialect <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data<span class="sc">$</span>locality)) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>    n_locality, <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a>data<span class="sc">$</span>dialect_clinal <span class="ot">&lt;-</span> data<span class="sc">$</span>clinal <span class="sc">*</span> data<span class="sc">$</span>dialect</span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co"># random variation</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>data<span class="sc">$</span>random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(data), <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb8-16"><a href="#cb8-16"></a></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co"># sort so lines look good in plot</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>data <span class="ot">&lt;-</span> data[<span class="fu">order</span>(data<span class="sc">$</span>lon), ]</span>
<span id="cb8-19"><a href="#cb8-19"></a></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co"># plot</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))</span>
<span id="cb8-22"><a href="#cb8-22"></a></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co"># random</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="fu">plot</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)), data<span class="sc">$</span>random, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Random"</span>,</span>
<span id="cb8-25"><a href="#cb8-25"></a>    <span class="at">xlab =</span> <span class="st">"Longitude"</span>, <span class="at">ylab =</span> <span class="st">"Call structure"</span>, <span class="at">col =</span> <span class="st">"#3E4A89FF"</span>,</span>
<span id="cb8-26"><a href="#cb8-26"></a>    <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-27"><a href="#cb8-27"></a></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co"># dialect</span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="fu">plot</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)), data<span class="sc">$</span>dialect, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Dialect"</span>,</span>
<span id="cb8-30"><a href="#cb8-30"></a>    <span class="at">xlab =</span> <span class="st">"Longitude"</span>, <span class="at">ylab =</span> <span class="st">"Call structure"</span>, <span class="at">col =</span> <span class="st">"#3E4A89FF"</span>,</span>
<span id="cb8-31"><a href="#cb8-31"></a>    <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-32"><a href="#cb8-32"></a></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="co"># dialect clinal</span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="fu">plot</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)), data<span class="sc">$</span>dialect_clinal, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Dialect * Clinal"</span>,</span>
<span id="cb8-35"><a href="#cb8-35"></a>    <span class="at">xlab =</span> <span class="st">"Longitude"</span>, <span class="at">ylab =</span> <span class="st">"Call structure"</span>, <span class="at">col =</span> <span class="st">"#3E4A89FF"</span>,</span>
<span id="cb8-36"><a href="#cb8-36"></a>    <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-37"><a href="#cb8-37"></a></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co"># clinal</span></span>
<span id="cb8-39"><a href="#cb8-39"></a><span class="fu">plot</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)), data<span class="sc">$</span>clinal, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Clinal"</span>,</span>
<span id="cb8-40"><a href="#cb8-40"></a>    <span class="at">xlab =</span> <span class="st">"Longitude"</span>, <span class="at">ylab =</span> <span class="st">"Call structure"</span>, <span class="at">col =</span> <span class="st">"#3E4A89FF"</span>,</span>
<span id="cb8-41"><a href="#cb8-41"></a>    <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Types of vocal geographic variation that were simulated</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="stats-on-simulated-data" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="stats-on-simulated-data"><span class="header-section-number">2.3</span> Stats on simulated data</h2>
<ul>
<li>Model:<br>
<span class="math display">\[\begin{align*}
Acoustic\ dissimilarity &amp;\sim locality + geographic\ distance
\end{align*}\]</span></li>
<li>Response values scaled</li>
</ul>
<p>Predict acoustic structure based on geographic distance and locality membership using multiple Regression on distance matrices</p>
<p>Data is z-transformed so all predictors have similar variance and effect sizes are comparable.</p>
<p>Variance for each predictor:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># create distance matrices</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>call_member_binary <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(PhenotypeSpace<span class="sc">::</span><span class="fu">binary_triangular_matrix</span>(<span class="at">group =</span> data<span class="sc">$</span>locality))</span>
<span id="cb9-3"><a href="#cb9-3"></a>clinal_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>clinal)</span>
<span id="cb9-4"><a href="#cb9-4"></a>dialect_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>dialect)</span>
<span id="cb9-5"><a href="#cb9-5"></a>dialect_clinal_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>dialect_clinal)</span>
<span id="cb9-6"><a href="#cb9-6"></a>random_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>random)</span>
<span id="cb9-7"><a href="#cb9-7"></a>geo_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data[, <span class="fu">c</span>(<span class="st">"lat"</span>, <span class="st">"lon"</span>)])</span>
<span id="cb9-8"><a href="#cb9-8"></a></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co"># regression models set data format</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>rect_var <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">clinal_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(clinal_dist)), <span class="at">dialect_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(dialect_dist)),</span>
<span id="cb9-11"><a href="#cb9-11"></a>    <span class="at">dialect_clinal_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(dialect_clinal_dist)), <span class="at">random_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(random_dist)),</span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="at">geo_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(geo_dist)), <span class="at">call_member_binary =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(call_member_binary)))</span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="fu">apply</span>(rect_var, <span class="dv">2</span>, var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        clinal_dist        dialect_dist dialect_clinal_dist         random_dist 
          0.9892355           1.0066857           1.2567040           0.9765539 
           geo_dist  call_member_binary 
          0.9883446           0.9045681 </code></pre>
</div>
</div>
<section id="dialect-type-variation-model" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="dialect-type-variation-model"><span class="header-section-number">2.3.1</span> Dialect-type variation model</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># model predicting dialect variation</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>(mod_dialect <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> dialect_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary,</span>
<span id="cb11-3"><a href="#cb11-3"></a>    <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"dialect_dist"</span>, <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$coef
                   dialect_dist  pval
Int                  0.03271626 1.000
geo_dist            -0.10646760 0.001
call_member_binary   0.38420019 0.001

$r.squared
       R2      pval 
0.1185022 0.0010000 

$F.test
       F   F.pval 
1337.405    0.001 </code></pre>
</div>
</div>
</section>
<section id="clinal-variation-model" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="clinal-variation-model"><span class="header-section-number">2.3.2</span> Clinal variation model</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># model predicting clinal variation</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>(mod_clinal <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> clinal_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary,</span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"clinal_dist"</span>, <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$coef
                     clinal_dist  pval
Int                 0.0005692781 0.001
geo_dist            1.0012211111 0.001
call_member_binary -0.0085714758 0.001

$r.squared
       R2      pval 
0.9962144 0.0010000 

$F.test
          F      F.pval 
2618035.995       0.001 </code></pre>
</div>
</div>
</section>
<section id="dialect-clinal-variation-model" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="dialect-clinal-variation-model"><span class="header-section-number">2.3.3</span> Dialect-clinal variation model</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># model predicting clinal variation</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>(mod_dialect_clinal <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> dialect_clinal_dist <span class="sc">~</span> geo_dist <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>    call_member_binary, <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"dialect_clinal_dist"</span>,</span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$coef
                   dialect_clinal_dist  pval
Int                          0.1123161 0.001
geo_dist                     0.3961117 0.001
call_member_binary           0.1974639 0.001

$r.squared
       R2      pval 
0.1901617 0.0010000 

$F.test
       F   F.pval 
2336.051    0.001 </code></pre>
</div>
</div>
</section>
<section id="random-variation-model" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="random-variation-model"><span class="header-section-number">2.3.4</span> Random variation model</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># model predicting random variation</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>(mod_random <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> random_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary,</span>
<span id="cb17-3"><a href="#cb17-3"></a>    <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"random_dist"</span>, <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$coef
                    random_dist  pval
Int                 0.008442725 0.039
geo_dist            0.021932428 0.189
call_member_binary -0.018189048 0.039

$r.squared
          R2         pval 
0.0005393112 0.1530000000 

$F.test
       F   F.pval 
5.368232 0.153000 </code></pre>
</div>
</div>
</section>
<section id="combined-results" class="level3" data-number="2.3.5">
<h3 data-number="2.3.5" class="anchored" data-anchor-id="combined-results"><span class="header-section-number">2.3.5</span> Combined results</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>mods <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mod_clinal =</span> mod_clinal, <span class="at">mod_dialect =</span> mod_dialect, <span class="at">mod_dialect_clinal =</span> mod_dialect_clinal,</span>
<span id="cb19-2"><a href="#cb19-2"></a>    <span class="at">mod_random =</span> mod_random)</span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="fu">names</span>(mods) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Clinal"</span>, <span class="st">"Dialect"</span>, <span class="st">"Dialect * clinal"</span>, <span class="st">"Random"</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a></span>
<span id="cb19-6"><a href="#cb19-6"></a>estimates <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">seq_along</span>(mods), <span class="cf">function</span>(x) {</span>
<span id="cb19-7"><a href="#cb19-7"></a>    Y <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mods[[x]]<span class="sc">$</span>coef[<span class="sc">-</span><span class="dv">1</span>, ])</span>
<span id="cb19-8"><a href="#cb19-8"></a>    Y<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> Y[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">max</span>(Y[, <span class="dv">1</span>])</span>
<span id="cb19-9"><a href="#cb19-9"></a>    Y<span class="sc">$</span>mod <span class="ot">&lt;-</span> <span class="fu">names</span>(mods)[x]</span>
<span id="cb19-10"><a href="#cb19-10"></a>    Y<span class="sc">$</span>predictor <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Y)</span>
<span id="cb19-11"><a href="#cb19-11"></a>    <span class="fu">names</span>(Y) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"coef"</span>, <span class="st">"p"</span>, <span class="st">"rel_coef"</span>, <span class="st">"model"</span>, <span class="st">"predictor"</span>)</span>
<span id="cb19-12"><a href="#cb19-12"></a>    <span class="fu">return</span>(Y)</span>
<span id="cb19-13"><a href="#cb19-13"></a>}))</span>
<span id="cb19-14"><a href="#cb19-14"></a></span>
<span id="cb19-15"><a href="#cb19-15"></a>estimates<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(estimates<span class="sc">$</span>p <span class="sc">&lt;</span> <span class="fl">0.05</span>, estimates<span class="sc">$</span>rel_coef,</span>
<span id="cb19-16"><a href="#cb19-16"></a>    <span class="dv">0</span>)</span>
<span id="cb19-17"><a href="#cb19-17"></a>estimates<span class="sc">$</span>signif <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(estimates<span class="sc">$</span>p <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"p &lt; 0.05"</span>, <span class="st">"p &gt;= 0.05"</span>)</span>
<span id="cb19-18"><a href="#cb19-18"></a></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="fu">ggplot</span>(estimates, <span class="fu">aes</span>(<span class="at">x =</span> predictor, <span class="at">y =</span> model, <span class="at">fill =</span> rel_coef)) <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_equal</span>() <span class="sc">+</span> <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="fu">viridis</span>(<span class="dv">10</span>)[<span class="dv">3</span>],</span>
<span id="cb19-21"><a href="#cb19-21"></a>    <span class="at">high =</span> <span class="fu">viridis</span>(<span class="dv">10</span>)[<span class="dv">7</span>], <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(coef,</span>
<span id="cb19-22"><a href="#cb19-22"></a>    <span class="dv">3</span>), <span class="at">color =</span> signif)) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>,</span>
<span id="cb19-23"><a href="#cb19-23"></a>    <span class="st">"gray"</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">"P value"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">angle =</span> <span class="dv">30</span>,</span>
<span id="cb19-25"><a href="#cb19-25"></a>        <span class="at">vjust =</span> <span class="fl">0.8</span>, <span class="at">hjust =</span> <span class="fl">0.8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="replicate-simulation-100-times" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="replicate-simulation-100-times"><span class="header-section-number">2.4</span> Replicate simulation 100 times</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>rep_models <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>, <span class="at">expr =</span> {</span>
<span id="cb20-2"><a href="#cb20-2"></a>    <span class="co"># number of groups</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>    n_locality <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a>    <span class="co"># number of individuals per group</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>    n_indiv <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a>    <span class="co"># simulate geographic coordinates along a gradient</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>    lon <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_locality, <span class="at">each =</span> n_indiv) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>        n_locality, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb20-11"><a href="#cb20-11"></a>    lat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span> n_locality, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb20-12"><a href="#cb20-12"></a></span>
<span id="cb20-13"><a href="#cb20-13"></a>    <span class="co"># create locality labels</span></span>
<span id="cb20-14"><a href="#cb20-14"></a>    localities <span class="ot">&lt;-</span> <span class="fu">sample</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span>n_locality])</span>
<span id="cb20-15"><a href="#cb20-15"></a></span>
<span id="cb20-16"><a href="#cb20-16"></a>    <span class="co"># put all together in a data frame</span></span>
<span id="cb20-17"><a href="#cb20-17"></a>    data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">locality =</span> <span class="fu">rep</span>(localities, <span class="at">each =</span> n_indiv),</span>
<span id="cb20-18"><a href="#cb20-18"></a>        lat, lon, <span class="at">color =</span> <span class="fu">viridis</span>(n_locality)[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_locality, <span class="at">each =</span> n_indiv)])</span>
<span id="cb20-19"><a href="#cb20-19"></a></span>
<span id="cb20-20"><a href="#cb20-20"></a>    <span class="co"># simulate acoustic structure vector clinal variation</span></span>
<span id="cb20-21"><a href="#cb20-21"></a>    data<span class="sc">$</span>clinal <span class="ot">&lt;-</span> data<span class="sc">$</span>lon <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(data), <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb20-22"><a href="#cb20-22"></a></span>
<span id="cb20-23"><a href="#cb20-23"></a>    <span class="co"># dialect type variation</span></span>
<span id="cb20-24"><a href="#cb20-24"></a>    data<span class="sc">$</span>dialect <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data<span class="sc">$</span>locality)) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span></span>
<span id="cb20-25"><a href="#cb20-25"></a>        n_locality, <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb20-26"><a href="#cb20-26"></a></span>
<span id="cb20-27"><a href="#cb20-27"></a>    data<span class="sc">$</span>dialect_clinal <span class="ot">&lt;-</span> data<span class="sc">$</span>clinal <span class="sc">*</span> data<span class="sc">$</span>dialect</span>
<span id="cb20-28"><a href="#cb20-28"></a></span>
<span id="cb20-29"><a href="#cb20-29"></a>    <span class="co"># random variation</span></span>
<span id="cb20-30"><a href="#cb20-30"></a>    data<span class="sc">$</span>random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(data), <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb20-31"><a href="#cb20-31"></a></span>
<span id="cb20-32"><a href="#cb20-32"></a>    <span class="co"># sort so lines look good in plot</span></span>
<span id="cb20-33"><a href="#cb20-33"></a>    data <span class="ot">&lt;-</span> data[<span class="fu">order</span>(data<span class="sc">$</span>lon), ]</span>
<span id="cb20-34"><a href="#cb20-34"></a></span>
<span id="cb20-35"><a href="#cb20-35"></a>    <span class="co"># create distance matrices</span></span>
<span id="cb20-36"><a href="#cb20-36"></a>    call_member_binary <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(PhenotypeSpace<span class="sc">::</span><span class="fu">binary_triangular_matrix</span>(<span class="at">group =</span> data<span class="sc">$</span>locality))</span>
<span id="cb20-37"><a href="#cb20-37"></a>    clinal_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>clinal)</span>
<span id="cb20-38"><a href="#cb20-38"></a>    dialect_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>dialect)</span>
<span id="cb20-39"><a href="#cb20-39"></a>    dialect_clinal_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>dialect_clinal)</span>
<span id="cb20-40"><a href="#cb20-40"></a>    random_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>random)</span>
<span id="cb20-41"><a href="#cb20-41"></a>    geo_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data[, <span class="fu">c</span>(<span class="st">"lat"</span>, <span class="st">"lon"</span>)])</span>
<span id="cb20-42"><a href="#cb20-42"></a></span>
<span id="cb20-43"><a href="#cb20-43"></a>    <span class="co"># regression models set data format</span></span>
<span id="cb20-44"><a href="#cb20-44"></a>    rect_var <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">clinal_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(clinal_dist)), <span class="at">dialect_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(dialect_dist)),</span>
<span id="cb20-45"><a href="#cb20-45"></a>        <span class="at">dialect_clinal_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(dialect_clinal_dist)),</span>
<span id="cb20-46"><a href="#cb20-46"></a>        <span class="at">random_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(random_dist)), <span class="at">geo_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(geo_dist)),</span>
<span id="cb20-47"><a href="#cb20-47"></a>        <span class="at">call_member_binary =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(call_member_binary)))</span>
<span id="cb20-48"><a href="#cb20-48"></a></span>
<span id="cb20-49"><a href="#cb20-49"></a>    <span class="co"># model predicting dialect variation</span></span>
<span id="cb20-50"><a href="#cb20-50"></a>    (mod_dialect <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> dialect_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary,</span>
<span id="cb20-51"><a href="#cb20-51"></a>        <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"dialect_dist"</span>, <span class="st">"geo_dist"</span>,</span>
<span id="cb20-52"><a href="#cb20-52"></a>            <span class="st">"call_member_binary"</span>)]))</span>
<span id="cb20-53"><a href="#cb20-53"></a></span>
<span id="cb20-54"><a href="#cb20-54"></a>    <span class="co"># model predicting clinal variation</span></span>
<span id="cb20-55"><a href="#cb20-55"></a>    (mod_clinal <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> clinal_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary,</span>
<span id="cb20-56"><a href="#cb20-56"></a>        <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"clinal_dist"</span>, <span class="st">"geo_dist"</span>,</span>
<span id="cb20-57"><a href="#cb20-57"></a>            <span class="st">"call_member_binary"</span>)]))</span>
<span id="cb20-58"><a href="#cb20-58"></a></span>
<span id="cb20-59"><a href="#cb20-59"></a>    <span class="co"># model predicting clinal variation</span></span>
<span id="cb20-60"><a href="#cb20-60"></a>    (mod_dialect_clinal <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> dialect_clinal_dist <span class="sc">~</span> geo_dist <span class="sc">+</span></span>
<span id="cb20-61"><a href="#cb20-61"></a>        call_member_binary, <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"dialect_clinal_dist"</span>,</span>
<span id="cb20-62"><a href="#cb20-62"></a>        <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]))</span>
<span id="cb20-63"><a href="#cb20-63"></a></span>
<span id="cb20-64"><a href="#cb20-64"></a>    <span class="co"># model predicting random variation</span></span>
<span id="cb20-65"><a href="#cb20-65"></a>    (mod_random <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> random_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary,</span>
<span id="cb20-66"><a href="#cb20-66"></a>        <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"random_dist"</span>, <span class="st">"geo_dist"</span>,</span>
<span id="cb20-67"><a href="#cb20-67"></a>            <span class="st">"call_member_binary"</span>)]))</span>
<span id="cb20-68"><a href="#cb20-68"></a></span>
<span id="cb20-69"><a href="#cb20-69"></a>    mods <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mod_clinal =</span> mod_clinal, <span class="at">mod_dialect =</span> mod_dialect,</span>
<span id="cb20-70"><a href="#cb20-70"></a>        <span class="at">mod_dialect_clinal =</span> mod_dialect_clinal, <span class="at">mod_random =</span> mod_random)</span>
<span id="cb20-71"><a href="#cb20-71"></a></span>
<span id="cb20-72"><a href="#cb20-72"></a>    <span class="fu">names</span>(mods) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Clinal"</span>, <span class="st">"Dialect"</span>, <span class="st">"Dialect * clinal"</span>, <span class="st">"Random"</span>)</span>
<span id="cb20-73"><a href="#cb20-73"></a></span>
<span id="cb20-74"><a href="#cb20-74"></a>    estimates <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">seq_along</span>(mods), <span class="cf">function</span>(x) {</span>
<span id="cb20-75"><a href="#cb20-75"></a>        Y <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mods[[x]]<span class="sc">$</span>coef[<span class="sc">-</span><span class="dv">1</span>, ])</span>
<span id="cb20-76"><a href="#cb20-76"></a>        Y<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> Y[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">max</span>(Y[, <span class="dv">1</span>])</span>
<span id="cb20-77"><a href="#cb20-77"></a>        Y<span class="sc">$</span>mod <span class="ot">&lt;-</span> <span class="fu">names</span>(mods)[x]</span>
<span id="cb20-78"><a href="#cb20-78"></a>        Y<span class="sc">$</span>predictor <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Y)</span>
<span id="cb20-79"><a href="#cb20-79"></a>        <span class="fu">names</span>(Y) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"coef"</span>, <span class="st">"p"</span>, <span class="st">"rel_coef"</span>, <span class="st">"model"</span>, <span class="st">"predictor"</span>)</span>
<span id="cb20-80"><a href="#cb20-80"></a>        <span class="fu">return</span>(Y)</span>
<span id="cb20-81"><a href="#cb20-81"></a>    }))</span>
<span id="cb20-82"><a href="#cb20-82"></a></span>
<span id="cb20-83"><a href="#cb20-83"></a>    estimates</span>
<span id="cb20-84"><a href="#cb20-84"></a>}, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-85"><a href="#cb20-85"></a></span>
<span id="cb20-86"><a href="#cb20-86"></a>coeffs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, <span class="fu">lapply</span>(rep_models, <span class="cf">function</span>(x) x[, <span class="dv">1</span>]))</span>
<span id="cb20-87"><a href="#cb20-87"></a>ps <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, <span class="fu">lapply</span>(rep_models, <span class="cf">function</span>(x) x[, <span class="dv">2</span>]))</span>
<span id="cb20-88"><a href="#cb20-88"></a></span>
<span id="cb20-89"><a href="#cb20-89"></a>estimates <span class="ot">&lt;-</span> rep_models[[<span class="dv">1</span>]]</span>
<span id="cb20-90"><a href="#cb20-90"></a>estimates<span class="sc">$</span>coef <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(coeffs)</span>
<span id="cb20-91"><a href="#cb20-91"></a>estimates<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(ps)</span>
<span id="cb20-92"><a href="#cb20-92"></a>estimates<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(ps)</span>
<span id="cb20-93"><a href="#cb20-93"></a></span>
<span id="cb20-94"><a href="#cb20-94"></a>estimates<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> estimates[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">max</span>(estimates[, <span class="dv">1</span>])</span>
<span id="cb20-95"><a href="#cb20-95"></a>estimates<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(estimates<span class="sc">$</span>p <span class="sc">&lt;</span> <span class="fl">0.05</span>, estimates<span class="sc">$</span>rel_coef,</span>
<span id="cb20-96"><a href="#cb20-96"></a>    <span class="dv">0</span>)</span>
<span id="cb20-97"><a href="#cb20-97"></a>estimates<span class="sc">$</span>signif <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(estimates<span class="sc">$</span>p <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"p &lt; 0.05"</span>, <span class="st">"p &gt;= 0.05"</span>)</span>
<span id="cb20-98"><a href="#cb20-98"></a></span>
<span id="cb20-99"><a href="#cb20-99"></a><span class="fu">saveRDS</span>(estimates, <span class="st">"./data/processed/estimates_for_replicated_simulation_dialects.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>estimates <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/estimates_for_replicated_simulation_dialects.RDS"</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="fu">ggplot</span>(estimates, <span class="fu">aes</span>(<span class="at">x =</span> predictor, <span class="at">y =</span> model, <span class="at">fill =</span> rel_coef)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_equal</span>() <span class="sc">+</span> <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="fu">viridis</span>(<span class="dv">10</span>)[<span class="dv">3</span>],</span>
<span id="cb21-5"><a href="#cb21-5"></a>    <span class="at">high =</span> <span class="fu">viridis</span>(<span class="dv">10</span>)[<span class="dv">7</span>], <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(coef,</span>
<span id="cb21-6"><a href="#cb21-6"></a>    <span class="dv">3</span>), <span class="at">color =</span> signif)) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>,</span>
<span id="cb21-7"><a href="#cb21-7"></a>    <span class="st">"gray"</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">"P value"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">angle =</span> <span class="dv">30</span>,</span>
<span id="cb21-9"><a href="#cb21-9"></a>        <span class="at">vjust =</span> <span class="fl">0.8</span>, <span class="at">hjust =</span> <span class="fl">0.8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- light green box -->
</section>
</section>
<section id="takeaways" class="level1 unnumbered unlisted alert alert-success">
<h1 class="unnumbered unlisted">Takeaways</h1>
<ul>
<li>Call membership has a stronger effect in dialect-type variation</li>
<li>Geographic distance has a stronger effect in clinal variation</li>
<li>Similar effect sizes when both clinal and dialect variation present</li>
</ul>
</section>
<p>&nbsp;</p>
<!-- '---' adds a gray vertical line -->
<section id="real-data-analysis" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Real data analysis</h1>
<section id="association-between-distance-call-similarity-geographic-distance-and-dialect-membership" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="association-between-distance-call-similarity-geographic-distance-and-dialect-membership"><span class="header-section-number">3.1</span> Association between distance call similarity, geographic distance and dialect membership</h2>
<ul>
<li>Using the function ecodist::MRM() <a href="https://search.r-project.org/CRAN/refmans/ecodist/html/MRM.html">https://search.r-project.org/CRAN/refmans/ecodist/html/MRM.html</a></li>
<li>Dialect membership expressed as binary matrix (0 = same dialect, 1 = different dialect)</li>
<li>Geographic distance expressed in 100 km units</li>
<li>Effect size expressed as acoustic similarity (changes in cross-correlation coefficients)</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>geo_dists <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"~/Dropbox/Projects/geographic_call_variation_yellow-naped_amazon/data/processed/pairwise_distances.RDS"</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>sels <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Dropbox/Projects/geographic_call_variation_yellow-naped_amazon/data/raw/ReducedVocalDataYNA.csv"</span>,</span>
<span id="cb22-3"><a href="#cb22-3"></a>    <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-4"><a href="#cb22-4"></a>xc <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"~/Dropbox/Projects/geographic_call_variation_yellow-naped_amazon/data/processed/SPCC2016_2018_2019.RDS"</span>)</span>
<span id="cb22-5"><a href="#cb22-5"></a></span>
<span id="cb22-6"><a href="#cb22-6"></a>geo_dists <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(geo_dists)</span>
<span id="cb22-7"><a href="#cb22-7"></a>call_member_binary <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(PhenotypeSpace<span class="sc">::</span><span class="fu">binary_triangular_matrix</span>(<span class="at">group =</span> sels<span class="sc">$</span>Call_Type))</span>
<span id="cb22-8"><a href="#cb22-8"></a></span>
<span id="cb22-9"><a href="#cb22-9"></a>rect_var <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">acous_sim =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(<span class="dv">1</span> <span class="sc">-</span> xc)), <span class="at">geo_dists =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(geo_dists)),</span>
<span id="cb22-10"><a href="#cb22-10"></a>    <span class="at">call_member_binary =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(call_member_binary)))</span>
<span id="cb22-11"><a href="#cb22-11"></a></span>
<span id="cb22-12"><a href="#cb22-12"></a></span>
<span id="cb22-13"><a href="#cb22-13"></a><span class="fu">colnames</span>(rect_var) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"acous_distance"</span>, <span class="st">"geo_dists"</span>, <span class="st">"call_member_binary"</span>)</span>
<span id="cb22-14"><a href="#cb22-14"></a></span>
<span id="cb22-15"><a href="#cb22-15"></a></span>
<span id="cb22-16"><a href="#cb22-16"></a><span class="co"># mod &lt;- MRM2(formula = acous_distance ~ geo_dists +</span></span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="co"># call_member_binary, nperm = 10000, mat = rect_var)</span></span>
<span id="cb22-18"><a href="#cb22-18"></a><span class="co"># saveRDS(mod,</span></span>
<span id="cb22-19"><a href="#cb22-19"></a><span class="co"># './data/processed/matrix_correlation_distance_vs_acoustic</span></span>
<span id="cb22-20"><a href="#cb22-20"></a><span class="co"># similarity.RDS')</span></span>
<span id="cb22-21"><a href="#cb22-21"></a></span>
<span id="cb22-22"><a href="#cb22-22"></a>rect_var_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(rect_var)</span>
<span id="cb22-23"><a href="#cb22-23"></a>rect_var_df<span class="sc">$</span>membership <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(call_member_binary <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"same"</span>,</span>
<span id="cb22-24"><a href="#cb22-24"></a>    <span class="st">"different"</span>)</span>
<span id="cb22-25"><a href="#cb22-25"></a></span>
<span id="cb22-26"><a href="#cb22-26"></a>gg_acous <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rect_var_df, <span class="fu">aes</span>(<span class="at">x =</span> geo_dists, <span class="at">y =</span> acous_distance,</span>
<span id="cb22-27"><a href="#cb22-27"></a>    <span class="at">color =</span> membership)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb22-28"><a href="#cb22-28"></a>    <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb22-29"><a href="#cb22-29"></a></span>
<span id="cb22-30"><a href="#cb22-30"></a>gg_acous</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># ggsave(gg_acous,</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co"># './output/acoustic_similarity_vs_distance.jpeg')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/matrix_correlation_distance_vs_acoustic similarity.RDS"</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a>mod</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$coef
                   acous_distance   pval
Int                   0.001520839 1.0000
geo_dists            -0.011493401 0.0027
call_member_binary    0.246687375 0.0001

$r.squared
        R2       pval 
0.06136759 0.00010000 

$F.test
         F     F.pval 
89307.1617     0.0001 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># # Read in .RDS file if you've already saved one</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>correl <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/correl_SPCC_100km.RDS"</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="fu">str</span>(correl)</span>
<span id="cb26-4"><a href="#cb26-4"></a></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co"># Create a dataframe from the mantel correlation matrix, remove</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co"># any existing NA's in the p-values. Create a vector of</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co"># significance values for the plot and match with appropriate</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co"># p-values in the dataframe.</span></span>
<span id="cb26-9"><a href="#cb26-9"></a>df1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(correl<span class="sc">$</span>mantel.res)</span>
<span id="cb26-10"><a href="#cb26-10"></a>df1 <span class="ot">&lt;-</span> df1[<span class="sc">!</span><span class="fu">is.na</span>(df1<span class="sc">$</span><span class="st">`</span><span class="at">Pr(corrected)</span><span class="st">`</span>), ]</span>
<span id="cb26-11"><a href="#cb26-11"></a></span>
<span id="cb26-12"><a href="#cb26-12"></a>sig <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df1<span class="sc">$</span><span class="st">`</span><span class="at">Pr(corrected)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="fl">0.05</span>, <span class="st">"sig"</span>, <span class="st">"non-sig"</span>)</span>
<span id="cb26-13"><a href="#cb26-13"></a></span>
<span id="cb26-14"><a href="#cb26-14"></a>p_val <span class="ot">&lt;-</span> df1<span class="sc">$</span><span class="st">`</span><span class="at">Pr(corrected)</span><span class="st">`</span></span>
<span id="cb26-15"><a href="#cb26-15"></a></span>
<span id="cb26-16"><a href="#cb26-16"></a>distance <span class="ot">&lt;-</span> df1<span class="sc">$</span>class.index</span>
<span id="cb26-17"><a href="#cb26-17"></a></span>
<span id="cb26-18"><a href="#cb26-18"></a>corr <span class="ot">&lt;-</span> df1<span class="sc">$</span>Mantel.cor</span>
<span id="cb26-19"><a href="#cb26-19"></a></span>
<span id="cb26-20"><a href="#cb26-20"></a>sig_cat <span class="ot">&lt;-</span> sig</span>
<span id="cb26-21"><a href="#cb26-21"></a>sig_cat[sig_cat <span class="sc">==</span> <span class="st">"sig"</span> <span class="sc">&amp;</span> corr <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">"Lower"</span></span>
<span id="cb26-22"><a href="#cb26-22"></a>sig_cat[sig_cat <span class="sc">==</span> <span class="st">"sig"</span> <span class="sc">&amp;</span> corr <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">"Higher"</span></span>
<span id="cb26-23"><a href="#cb26-23"></a>sig_cat[sig_cat <span class="sc">==</span> <span class="st">"non-sig"</span>] <span class="ot">&lt;-</span> <span class="st">"Neutral"</span></span>
<span id="cb26-24"><a href="#cb26-24"></a><span class="fu">unique</span>(sig_cat)</span>
<span id="cb26-25"><a href="#cb26-25"></a></span>
<span id="cb26-26"><a href="#cb26-26"></a>corr_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">distance =</span> distance, <span class="at">corr =</span> corr, <span class="at">p_val =</span> p_val,</span>
<span id="cb26-27"><a href="#cb26-27"></a>    <span class="at">sig =</span> sig, <span class="at">sig_cat =</span> sig_cat)</span>
<span id="cb26-28"><a href="#cb26-28"></a>corr_df<span class="sc">$</span>sig <span class="ot">&lt;-</span> <span class="fu">factor</span>(corr_df<span class="sc">$</span>sig, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sig"</span>, <span class="st">"non-sig"</span>))</span>
<span id="cb26-29"><a href="#cb26-29"></a>corr_df<span class="sc">$</span>sig_cat <span class="ot">&lt;-</span> <span class="fu">factor</span>(corr_df<span class="sc">$</span>sig_cat, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Lower"</span>, <span class="st">"Neutral"</span>,</span>
<span id="cb26-30"><a href="#cb26-30"></a>    <span class="st">"Higher"</span>))</span>
<span id="cb26-31"><a href="#cb26-31"></a></span>
<span id="cb26-32"><a href="#cb26-32"></a><span class="co"># Adjust the x- and y-axis scales using ggplot: c(0, 15)</span></span>
<span id="cb26-33"><a href="#cb26-33"></a><span class="co"># install.packages('scales') install.packages('ggplot2')</span></span>
<span id="cb26-34"><a href="#cb26-34"></a>scales_x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Central_America =</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb26-35"><a href="#cb26-35"></a>    <span class="dv">15</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">5</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">5</span>)))</span>
<span id="cb26-36"><a href="#cb26-36"></a></span>
<span id="cb26-37"><a href="#cb26-37"></a>scales_y <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SPCC =</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)))</span>
<span id="cb26-38"><a href="#cb26-38"></a></span>
<span id="cb26-39"><a href="#cb26-39"></a><span class="fu">str</span>(corr_df)</span>
<span id="cb26-40"><a href="#cb26-40"></a></span>
<span id="cb26-41"><a href="#cb26-41"></a><span class="co"># Plot the spatial autocorrelogram using ggplot</span></span>
<span id="cb26-42"><a href="#cb26-42"></a><span class="co"># jpeg('Spatial_auto100km.tiff', units='in', width=10,</span></span>
<span id="cb26-43"><a href="#cb26-43"></a><span class="co"># height=10, res=300) this never works</span></span>
<span id="cb26-44"><a href="#cb26-44"></a><span class="fu">ggplot</span>(corr_df, <span class="fu">aes</span>(<span class="at">x =</span> distance, <span class="at">y =</span> corr)) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,</span>
<span id="cb26-45"><a href="#cb26-45"></a>    <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> sig_cat,</span>
<span id="cb26-46"><a href="#cb26-46"></a>    <span class="at">fill =</span> sig_cat), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">alpha</span>(<span class="st">"darkblue"</span>,</span>
<span id="cb26-47"><a href="#cb26-47"></a>    <span class="fl">0.6</span>), <span class="fu">gray.colors</span>(<span class="dv">12</span>)[<span class="dv">6</span>], <span class="st">"red"</span>)) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">alpha</span>(<span class="st">"darkblue"</span>,</span>
<span id="cb26-48"><a href="#cb26-48"></a>    <span class="fl">0.6</span>), <span class="fu">gray.colors</span>(<span class="dv">12</span>)[<span class="dv">6</span>], <span class="st">"red"</span>)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb26-49"><a href="#cb26-49"></a>    <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb26-50"><a href="#cb26-50"></a>    <span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>,</span>
<span id="cb26-51"><a href="#cb26-51"></a>    <span class="at">color =</span> <span class="st">"black"</span>), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.35</span>),</span>
<span id="cb26-52"><a href="#cb26-52"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-53"><a href="#cb26-53"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-54"><a href="#cb26-54"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>), <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.15</span>),</span>
<span id="cb26-55"><a href="#cb26-55"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">18</span>), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb26-56"><a href="#cb26-56"></a>        <span class="at">size =</span> <span class="dv">18</span>), <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-57"><a href="#cb26-57"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>, <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb26-58"><a href="#cb26-58"></a>    <span class="fu">xlab</span>(<span class="st">"Pairwise Geographic Distance (km)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Mantel Spatial Correlation of Acoustic Similarity"</span>) <span class="sc">+</span></span>
<span id="cb26-59"><a href="#cb26-59"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Spatial Correlation Values"</span>),</span>
<span id="cb26-60"><a href="#cb26-60"></a>        <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Spatial Correlation Values"</span>))</span>
<span id="cb26-61"><a href="#cb26-61"></a></span>
<span id="cb26-62"><a href="#cb26-62"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>count_call <span class="ot">&lt;-</span> <span class="fu">table</span>(sels<span class="sc">$</span>Call_Type)</span>
<span id="cb27-2"><a href="#cb27-2"></a></span>
<span id="cb27-3"><a href="#cb27-3"></a>sels <span class="ot">&lt;-</span> sels[<span class="fu">order</span>(<span class="fu">match</span>(sels<span class="sc">$</span>Call_Type, <span class="fu">names</span>(count_call)[<span class="fu">order</span>(count_call)])),</span>
<span id="cb27-4"><a href="#cb27-4"></a>    ]</span>
<span id="cb27-5"><a href="#cb27-5"></a></span>
<span id="cb27-6"><a href="#cb27-6"></a>combs <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">combn</span>(sels<span class="sc">$</span>selsID, <span class="at">m =</span> <span class="dv">2</span>))</span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="co"># combs &lt;- combs[sapply(strsplit(combs[,1], '-'), '[', 1) !=</span></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co"># sapply(strsplit(combs[,2], '-'), '[', 1), ]</span></span>
<span id="cb27-9"><a href="#cb27-9"></a></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="fu">nrow</span>(combs)</span>
<span id="cb27-11"><a href="#cb27-11"></a></span>
<span id="cb27-12"><a href="#cb27-12"></a>combs <span class="ot">&lt;-</span> combs[<span class="sc">!</span><span class="fu">duplicated</span>(combs[, <span class="dv">2</span>]), ]</span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co"># diff_combs &lt;- diff_combs[!duplicated(diff_combs[,2]), ]</span></span>
<span id="cb27-14"><a href="#cb27-14"></a></span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="co"># keep &lt;- TRUE for(x in 2:nrow(combs)){ prev &lt;-</span></span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="co"># unique(c(combs[seq_len(x - 1), , drop = FALSE][keep, ]))</span></span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="co"># keep[x] &lt;- !any(combs[x, ] %in% prev) } combs &lt;- combs[keep, ]</span></span>
<span id="cb27-18"><a href="#cb27-18"></a></span>
<span id="cb27-19"><a href="#cb27-19"></a>combs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(combs)</span>
<span id="cb27-20"><a href="#cb27-20"></a></span>
<span id="cb27-21"><a href="#cb27-21"></a>geo_dists <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/pairwise_distances.RDS"</span>)</span>
<span id="cb27-22"><a href="#cb27-22"></a></span>
<span id="cb27-23"><a href="#cb27-23"></a>combs<span class="sc">$</span>geo_dist <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(combs), <span class="cf">function</span>(x) {</span>
<span id="cb27-24"><a href="#cb27-24"></a></span>
<span id="cb27-25"><a href="#cb27-25"></a>    geo_dists[<span class="fu">rownames</span>(geo_dists) <span class="sc">==</span> combs[x, <span class="dv">1</span>], <span class="fu">colnames</span>(geo_dists) <span class="sc">==</span></span>
<span id="cb27-26"><a href="#cb27-26"></a>        combs[x, <span class="dv">2</span>]]</span>
<span id="cb27-27"><a href="#cb27-27"></a></span>
<span id="cb27-28"><a href="#cb27-28"></a>})</span>
<span id="cb27-29"><a href="#cb27-29"></a></span>
<span id="cb27-30"><a href="#cb27-30"></a>combs<span class="sc">$</span>call_dist <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(combs), <span class="cf">function</span>(x) {</span>
<span id="cb27-31"><a href="#cb27-31"></a></span>
<span id="cb27-32"><a href="#cb27-32"></a>    xc[<span class="fu">rownames</span>(xc) <span class="sc">==</span> combs[x, <span class="dv">1</span>], <span class="fu">colnames</span>(xc) <span class="sc">==</span> combs[x, <span class="dv">2</span>]]</span>
<span id="cb27-33"><a href="#cb27-33"></a></span>
<span id="cb27-34"><a href="#cb27-34"></a>})</span>
<span id="cb27-35"><a href="#cb27-35"></a></span>
<span id="cb27-36"><a href="#cb27-36"></a><span class="fu">range</span>(combs<span class="sc">$</span>call_dist)</span>
<span id="cb27-37"><a href="#cb27-37"></a></span>
<span id="cb27-38"><a href="#cb27-38"></a>combs<span class="sc">$</span>call_dist <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> combs<span class="sc">$</span>call_dist</span>
<span id="cb27-39"><a href="#cb27-39"></a></span>
<span id="cb27-40"><a href="#cb27-40"></a><span class="fu">names</span>(combs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"call.type1"</span>, <span class="st">"call.type2"</span>, <span class="st">"geo.dist"</span>, <span class="st">"acoustic.dist"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- '&nbsp;' adds blank space -->
<!-- light green box -->
</section>
</section>
<section id="takeaways-1" class="level1 unnumbered unlisted alert alert-success">
<h1 class="unnumbered unlisted">Takeaways</h1>
<ul>
<li>Changes in acoustic similarity largely due to dialects: calls from the same dialect are way more similar</li>
<li>There is also a small positive effect of geoprahic distance on acoustic similarity: calls further away are slightly more similar</li>
</ul>
</section>
<p>&nbsp;</p>
<!-- '---' adds a gray vertical line -->
<hr>
<p>&nbsp;</p>
<p><!-- add packages used, system details and versions  --></p>
<section id="session-information" class="level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">Session information</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.1.0 (2021-05-18)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3
LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3

locale:
 [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=pt_BR.UTF-8    
 [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=pt_BR.UTF-8   
 [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] ecodist_2.0.9        brmsish_1.0.0        brms_2.18.0         
 [4] Rcpp_1.0.11          PhenotypeSpace_0.1.0 warbleR_1.1.28      
 [7] NatureSounds_1.0.4   seewave_2.2.0        tuneR_1.4.4         
[10] caret_6.0-88         viridis_0.6.3        viridisLite_0.4.2   
[13] pbapply_1.7-2        ggplot2_3.4.2        vegan_2.5-7         
[16] lattice_0.21-8       permute_0.9-5        spData_2.2.1        
[19] raster_3.4-13        dplyr_1.0.10         rgeos_0.5-5         
[22] rgdal_1.5-23         sp_1.5-1             rprojroot_2.0.3     
[25] formatR_1.11         knitr_1.43          

loaded via a namespace (and not attached):
  [1] utf8_1.2.3            tidyselect_1.2.0      lme4_1.1-27.1        
  [4] fftw_1.0-7            htmlwidgets_1.5.4     grid_4.1.0           
  [7] pROC_1.17.0.1         munsell_0.5.0         ragg_1.1.3           
 [10] codetools_0.2-18      DT_0.26               miniUI_0.1.1.1       
 [13] withr_2.5.0           Brobdingnag_1.2-9     colorspace_2.1-0     
 [16] rstudioapi_0.14       stats4_4.1.0          dtw_1.23-1           
 [19] tensor_1.5            bayesplot_1.9.0       labeling_0.4.2       
 [22] emmeans_1.8.1-1       rstan_2.21.7          polyclip_1.10-0      
 [25] farver_2.1.1          bridgesampling_1.1-2  coda_0.19-4          
 [28] vctrs_0.6.3           generics_0.1.3        TH.data_1.1-0        
 [31] ipred_0.9-11          xfun_0.39             R6_2.5.1             
 [34] markdown_1.3          gamm4_0.2-6           projpred_2.0.2       
 [37] bitops_1.0-7          spatstat.utils_2.2-0  assertthat_0.2.1     
 [40] promises_1.2.0.1      scales_1.2.1          multcomp_1.4-17      
 [43] nnet_7.3-16           gtable_0.3.3          processx_3.8.2       
 [46] goftest_1.2-2         xaringanExtra_0.7.0   sandwich_3.0-1       
 [49] timeDate_3043.102     rlang_1.1.1           systemfonts_1.0.4    
 [52] splines_4.1.0         ModelMetrics_1.2.2.2  spatstat.geom_2.2-2  
 [55] sketchy_1.0.2         checkmate_2.2.0       inline_0.3.19        
 [58] yaml_2.3.7            reshape2_1.4.4        abind_1.4-5          
 [61] threejs_0.3.3         crosstalk_1.2.0       backports_1.4.1      
 [64] httpuv_1.6.6          tensorA_0.36.2        tools_4.1.0          
 [67] lava_1.6.9            kableExtra_1.3.4      ellipsis_0.3.2       
 [70] spatstat.core_2.3-0   posterior_1.3.1       proxy_0.4-27         
 [73] ggridges_0.5.4        plyr_1.8.7            base64enc_0.1-3      
 [76] purrr_1.0.0           RCurl_1.98-1.12       ps_1.7.5             
 [79] prettyunits_1.1.1     rpart_4.1-15          deldir_0.2-10        
 [82] cowplot_1.1.1         zoo_1.8-11            cluster_2.1.2        
 [85] magrittr_2.0.3        data.table_1.14.0     ggdist_3.2.0         
 [88] colourpicker_1.2.0    mvtnorm_1.1-3         packrat_0.9.0        
 [91] matrixStats_0.62.0    shinyjs_2.1.0         mime_0.12            
 [94] evaluate_0.21         xtable_1.8-4          shinystan_2.6.0      
 [97] gridExtra_2.3         rstantools_2.2.0      testthat_3.1.9       
[100] compiler_4.1.0        tibble_3.2.1          crayon_1.5.2         
[103] minqa_1.2.4           StanHeaders_2.21.0-7  htmltools_0.5.5      
[106] mgcv_1.8-42           later_1.3.0           RcppParallel_5.1.5   
[109] lubridate_1.7.10      DBI_1.1.3             MASS_7.3-60          
[112] boot_1.3-28           Matrix_1.5-4.1        brio_1.1.3           
[115] cli_3.6.1             parallel_4.1.0        gower_0.2.2          
[118] igraph_1.5.0          pkgconfig_2.0.3       signal_0.7-7         
[121] spatstat.sparse_2.0-0 recipes_0.1.16        xml2_1.3.3           
[124] foreach_1.5.1         svglite_2.1.0         dygraphs_1.1.1.6     
[127] webshot_0.5.4         estimability_1.4.1    prodlim_2019.11.13   
[130] rvest_1.0.3           stringr_1.5.0         distributional_0.3.1 
[133] callr_3.7.3           digest_0.6.32         spatstat.data_2.1-0  
[136] rmarkdown_2.23        shiny_1.7.3           gtools_3.9.3         
[139] nloptr_1.2.2.2        rjson_0.2.21          lifecycle_1.0.3      
[142] nlme_3.1-162          jsonlite_1.8.7        fansi_1.0.4          
[145] pillar_1.9.0          loo_2.4.1.9000        httr_1.4.4           
[148] fastmap_1.1.1         pkgbuild_1.4.0        survival_3.2-11      
[151] glue_1.6.2            xts_0.12.2            remotes_2.4.2        
[154] shinythemes_1.2.0     iterators_1.0.13      class_7.3-22         
[157] stringi_1.7.12        textshaping_0.3.5     ape_5.6-2            </code></pre>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb29" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Geographic call variation in yellow-naped amazon across its entire geographic range</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> Statistical analysis</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> &lt;a href="http://marceloarayasalas.weebly.com/"&gt;Marcelo Araya-Salas, PhD&lt;/a&gt;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 2</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="an">toc-location:</span><span class="co"> left</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="an">highlight-style:</span><span class="co"> pygments</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: kable</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co">    css: qmd.css</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- this code add line numbers to code blocks --&gt;</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- only works when code folding is not used in yaml (code_folding: show) --&gt;</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="in">body</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="in">  { counter-reset: source-line 0; }</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="in">pre.numberSource code</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="in">  { counter-reset: none; }</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{r set root directory, echo = FALSE}</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a><span class="co"># set working directory as project directory or one directory above,</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>rootdir <span class="ot">&lt;-</span> <span class="fu">try</span>(rprojroot<span class="sc">::</span><span class="fu">find_rstudio_root_file</span>(), <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">is</span>(rootdir, <span class="st">"try-error"</span>)) rootdir <span class="ot">&lt;-</span>  <span class="st">".."</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">set</span>(<span class="at">root.dir =</span> rootdir)</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r add link to github repo, echo = FALSE, results='asis'}</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a><span class="co"># print link to github repo if any</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"./.git/config"</span>)){</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>  config <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"./.git/config"</span>)</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"url"</span>,  config, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">turl = |.git$"</span>, <span class="st">""</span>, url)</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Source code and data found at ["</span>, url, <span class="st">"]("</span>, url, <span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup style, echo = FALSE, message = FALSE, warning=FALSE}</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a><span class="co"># options to customize chunk outputs</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">class.source =</span> <span class="st">"numberLines lineAnchors"</span>, <span class="co"># for code line numbers</span></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">tidy.opts =</span> <span class="fu">list</span>(<span class="at">width.cutoff =</span> <span class="dv">65</span>), </span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">tidy =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a> )</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- skyblue box --&gt;</span></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">class</span><span class="ot">=</span><span class="st">"alert alert-info"</span><span class="kw">&gt;</span></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a><span class="fu"># Purpose {.unnumbered .unlisted}</span></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Evaluate call structure variation and ist relation to the geographic distanc</span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a><span class="fu"># Load packages {.unnumbered .unlisted}</span></span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load packages}</span></span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr is require for creating html/pdf/word reports</span></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a><span class="co"># formatR is used for soft-wrapping code</span></span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a><span class="co"># install/ load packages</span></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>sketchy<span class="sc">::</span><span class="fu">load_packages</span>(<span class="at">packages =</span> <span class="fu">c</span>(<span class="st">"knitr"</span>, <span class="st">"formatR"</span>, <span class="st">"rprojroot"</span>, <span class="st">"sp"</span>, <span class="st">"rgdal"</span>, <span class="st">"rgeos"</span>, <span class="st">"dplyr"</span>, <span class="st">"raster"</span>, <span class="st">"dplyr"</span>, <span class="st">"spData"</span>, <span class="st">"vegan"</span>, <span class="st">"ggplot2"</span>, <span class="st">"pbapply"</span>, <span class="st">"viridis"</span>, <span class="st">"caret"</span>, <span class="at">github =</span> <span class="st">"PhenotypeSpace"</span>, <span class="st">"brms"</span>, <span class="at">github =</span> <span class="st">"brmsish"</span>, <span class="st">"ecodist"</span>))</span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"./scripts/MRM2.R"</span>)</span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data analysis</span></span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a><span class="fu">## Read data</span></span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in and convert the dataframe to Spatial Points object.</span></span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a>sels <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/raw/ReducedVocalDataYNA.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a>sels<span class="sc">$</span>Latitude <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sels<span class="sc">$</span>Latitude)</span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a>sels<span class="sc">$</span>Longitude <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sels<span class="sc">$</span>Longitude)</span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a>sels<span class="sc">$</span>Latitude <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(sels<span class="sc">$</span>Latitude)</span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a>sels<span class="sc">$</span>Longitude <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(sels<span class="sc">$</span>Longitude)</span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a>sels <span class="ot">&lt;-</span> sels[<span class="fu">order</span>(sels<span class="sc">$</span>Call_Type), ]</span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a>sels<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(sels))</span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a>  sels<span class="sc">$</span>id[i] <span class="ot">&lt;-</span> <span class="cf">if</span> (sels<span class="sc">$</span>Call_Type[i] <span class="sc">==</span> sels<span class="sc">$</span>Call_Type[i <span class="sc">-</span> <span class="dv">1</span>]) sels<span class="sc">$</span>id[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a>sels<span class="sc">$</span>selsID <span class="ot">&lt;-</span> <span class="fu">paste</span>(sels<span class="sc">$</span>Call_Type, sels<span class="sc">$</span>id, <span class="at">sep =</span> <span class="st">"-"</span>) </span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a>xc <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/SPCC2016_2018_2019.RDS"</span>)</span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a>xc <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(xc)</span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(xc) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(xc) <span class="ot">&lt;-</span> sels<span class="sc">$</span>selsID</span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compute geographic distance</span></span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the dataframe to Spatial Points object.</span></span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lon =</span> sels<span class="sc">$</span>Longitude, <span class="at">lat =</span> sels<span class="sc">$</span>Latitude)</span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mat)</span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a>sp_pts <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(mat, <span class="at">proj4string =</span> <span class="fu">CRS</span>(<span class="st">"+proj=longlat +ellps=GRS80 +no_defs +init:epsg31972"</span>))</span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-135"><a href="#cb29-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproject using EPSG codes</span></span>
<span id="cb29-136"><a href="#cb29-136" aria-hidden="true" tabindex="-1"></a><span class="co"># EPSG codes are specific to regions across the world. Codes can be accessed at the following site: http://epsg.io or by searching for other EPSG repositories online.</span></span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a>epsg <span class="ot">&lt;-</span> rgdal<span class="sc">::</span><span class="fu">make_EPSG</span>()</span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a>epsg[<span class="fu">grep</span>(<span class="st">"^31972$"</span>, epsg<span class="sc">$</span>code), ]</span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a>sp_pts <span class="ot">&lt;-</span> sp<span class="sc">::</span><span class="fu">spTransform</span>(sp_pts, <span class="at">CRSobj =</span> <span class="fu">CRS</span>(epsg<span class="sc">$</span>prj4[<span class="fu">grep</span>(<span class="st">"^31972$"</span>, epsg<span class="sc">$</span>code)]))</span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a><span class="fu">bbox</span>(sp_pts)</span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a><span class="fu">proj4string</span>(sp_pts)</span>
<span id="cb29-143"><a href="#cb29-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-144"><a href="#cb29-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the pairwise distances</span></span>
<span id="cb29-145"><a href="#cb29-145" aria-hidden="true" tabindex="-1"></a>geo_dists <span class="ot">&lt;-</span> rgeos<span class="sc">::</span><span class="fu">gDistance</span>(sp_pts, <span class="at">byid =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-146"><a href="#cb29-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-147"><a href="#cb29-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-148"><a href="#cb29-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-149"><a href="#cb29-149" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(geo_dists) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(geo_dists) <span class="ot">&lt;-</span> sels<span class="sc">$</span>selsID</span>
<span id="cb29-150"><a href="#cb29-150" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(geo_dists)</span>
<span id="cb29-151"><a href="#cb29-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-152"><a href="#cb29-152" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(geo_dists, <span class="st">"./data/processed/pairwise_distances.RDS"</span>)</span>
<span id="cb29-153"><a href="#cb29-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-154"><a href="#cb29-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-155"><a href="#cb29-155" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mantel correlogram</span></span>
<span id="cb29-156"><a href="#cb29-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-157"><a href="#cb29-157" aria-hidden="true" tabindex="-1"></a>Average interpolated distances from correlograms at 25, 50, 100, 150, 200 and 250 km</span>
<span id="cb29-158"><a href="#cb29-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-159"><a href="#cb29-159" aria-hidden="true" tabindex="-1"></a><span class="fu">### Compute mantel correlogram at different distances</span></span>
<span id="cb29-160"><a href="#cb29-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb29-161"><a href="#cb29-161" aria-hidden="true" tabindex="-1"></a>geo_dists <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/pairwise_distances.RDS"</span>)</span>
<span id="cb29-162"><a href="#cb29-162" aria-hidden="true" tabindex="-1"></a><span class="co"># View("geo_dists")</span></span>
<span id="cb29-163"><a href="#cb29-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-164"><a href="#cb29-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Projection is in meters, so we convert to km</span></span>
<span id="cb29-165"><a href="#cb29-165" aria-hidden="true" tabindex="-1"></a>geo_dists <span class="ot">&lt;-</span> <span class="fu">round</span>(geo_dists<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb29-166"><a href="#cb29-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-167"><a href="#cb29-167" aria-hidden="true" tabindex="-1"></a><span class="co"># When we plot our data, we want the points to be connected in one continuous line. In order to achieve that, we identified "breaks" in distances using the following code. Break intervals are measured in km, and once a break limit was chosen we checked the number of existing 0's by creating a table of the classes. If a 0 shows in one of the classes, that class has no data and the break number should be altered. Although not essential, minimizing zeros maintains continuity in the plotted line for the graphic.</span></span>
<span id="cb29-168"><a href="#cb29-168" aria-hidden="true" tabindex="-1"></a>geo_vect <span class="ot">&lt;-</span> geo_dists[<span class="fu">lower.tri</span>(geo_dists)]</span>
<span id="cb29-169"><a href="#cb29-169" aria-hidden="true" tabindex="-1"></a>geo_vect <span class="ot">&lt;-</span> geo_vect[geo_vect <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(geo_vect)]</span>
<span id="cb29-170"><a href="#cb29-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-171"><a href="#cb29-171" aria-hidden="true" tabindex="-1"></a><span class="co"># read cross-correlation data</span></span>
<span id="cb29-172"><a href="#cb29-172" aria-hidden="true" tabindex="-1"></a>xc <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/SPCC2016_2018_2019.RDS"</span>)</span>
<span id="cb29-173"><a href="#cb29-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-174"><a href="#cb29-174" aria-hidden="true" tabindex="-1"></a>xc_dist <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> xc</span>
<span id="cb29-175"><a href="#cb29-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-176"><a href="#cb29-176" aria-hidden="true" tabindex="-1"></a>dists <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">250</span>)</span>
<span id="cb29-177"><a href="#cb29-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-178"><a href="#cb29-178" aria-hidden="true" tabindex="-1"></a>mantel_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(dists, <span class="at">cl =</span> <span class="dv">18</span>, <span class="cf">function</span>(i){</span>
<span id="cb29-179"><a href="#cb29-179" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-180"><a href="#cb29-180" aria-hidden="true" tabindex="-1"></a>     classes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(geo_dists), i)</span>
<span id="cb29-181"><a href="#cb29-181" aria-hidden="true" tabindex="-1"></a>    <span class="co"># length(classes)</span></span>
<span id="cb29-182"><a href="#cb29-182" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-183"><a href="#cb29-183" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Run a mantel correlation on the data</span></span>
<span id="cb29-184"><a href="#cb29-184" aria-hidden="true" tabindex="-1"></a>    correl_SPCC <span class="ot">&lt;-</span> vegan<span class="sc">::</span><span class="fu">mantel.correlog</span>(<span class="at">D.eco =</span> xc_dist, <span class="at">D.geo =</span> geo_dists, <span class="at">break.pts =</span> classes, <span class="at">cutoff =</span> <span class="cn">FALSE</span>, <span class="at">r.type =</span> <span class="st">"pearson"</span>, <span class="at">nperm =</span> <span class="dv">1</span>, <span class="at">mult =</span> <span class="st">"holm"</span>, <span class="at">progressive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-185"><a href="#cb29-185" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-186"><a href="#cb29-186" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-187"><a href="#cb29-187" aria-hidden="true" tabindex="-1"></a>    mantel.res <span class="ot">&lt;-</span> correl_SPCC<span class="sc">$</span>mantel.res[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb29-188"><a href="#cb29-188" aria-hidden="true" tabindex="-1"></a>    mantel.res <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mantel.res, <span class="at">break.size =</span> i)</span>
<span id="cb29-189"><a href="#cb29-189" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-190"><a href="#cb29-190" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(mantel.res)</span>
<span id="cb29-191"><a href="#cb29-191" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-192"><a href="#cb29-192" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb29-193"><a href="#cb29-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-194"><a href="#cb29-194" aria-hidden="true" tabindex="-1"></a>mantel_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(mantel_list, as.data.frame)</span>
<span id="cb29-195"><a href="#cb29-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-196"><a href="#cb29-196" aria-hidden="true" tabindex="-1"></a><span class="co"># # Save the correlation as an .RDS file so you don't have to run it multiple times in the future</span></span>
<span id="cb29-197"><a href="#cb29-197" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(mantel_list, <span class="fu">paste0</span>(<span class="st">"./data/processed/correl_SPCC_several_distances.RDS"</span>))</span>
<span id="cb29-198"><a href="#cb29-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-199"><a href="#cb29-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-200"><a href="#cb29-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-201"><a href="#cb29-201" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot mean correlogram</span></span>
<span id="cb29-202"><a href="#cb29-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb29-203"><a href="#cb29-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-204"><a href="#cb29-204" aria-hidden="true" tabindex="-1"></a>mantel_list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(<span class="st">"./data/processed/correl_SPCC_several_distances.RDS"</span>))</span>
<span id="cb29-205"><a href="#cb29-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-206"><a href="#cb29-206" aria-hidden="true" tabindex="-1"></a>mantels_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(rbind, mantel_list))</span>
<span id="cb29-207"><a href="#cb29-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-208"><a href="#cb29-208" aria-hidden="true" tabindex="-1"></a>combined_dists <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(mantels_df<span class="sc">$</span>class.index))</span>
<span id="cb29-209"><a href="#cb29-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-210"><a href="#cb29-210" aria-hidden="true" tabindex="-1"></a><span class="co"># interpolate</span></span>
<span id="cb29-211"><a href="#cb29-211" aria-hidden="true" tabindex="-1"></a>interpol_mantel_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(mantel_list, <span class="cf">function</span>(x){</span>
<span id="cb29-212"><a href="#cb29-212" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-213"><a href="#cb29-213" aria-hidden="true" tabindex="-1"></a>    appx <span class="ot">&lt;-</span> <span class="fu">approx</span>(<span class="at">x =</span> x<span class="sc">$</span>class.index[x<span class="sc">$</span>n.dist <span class="sc">&gt;</span> <span class="dv">0</span>], <span class="at">y =</span> x<span class="sc">$</span>Mantel.cor[x<span class="sc">$</span>n.dist <span class="sc">&gt;</span> <span class="dv">0</span>],</span>
<span id="cb29-214"><a href="#cb29-214" aria-hidden="true" tabindex="-1"></a>                <span class="at">xout =</span> combined_dists,</span>
<span id="cb29-215"><a href="#cb29-215" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"linear"</span>)</span>
<span id="cb29-216"><a href="#cb29-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-217"><a href="#cb29-217" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(appx<span class="sc">$</span>y)</span>
<span id="cb29-218"><a href="#cb29-218" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb29-219"><a href="#cb29-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-220"><a href="#cb29-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-221"><a href="#cb29-221" aria-hidden="true" tabindex="-1"></a>interpol_mantel_mat <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, interpol_mantel_list)</span>
<span id="cb29-222"><a href="#cb29-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-223"><a href="#cb29-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-224"><a href="#cb29-224" aria-hidden="true" tabindex="-1"></a>interpol_mantel_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(combined_dists, </span>
<span id="cb29-225"><a href="#cb29-225" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">mean.cor =</span> <span class="fu">apply</span>(interpol_mantel_mat, <span class="dv">1</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-226"><a href="#cb29-226" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sd.cor =</span> <span class="fu">apply</span>(interpol_mantel_mat, <span class="dv">1</span>, sd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb29-227"><a href="#cb29-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-228"><a href="#cb29-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-229"><a href="#cb29-229" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> interpol_mantel_df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> combined_dists, <span class="at">y =</span> mean.cor)) <span class="sc">+</span></span>
<span id="cb29-230"><a href="#cb29-230" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_ribbon</span>(<span class="at">data =</span> interpol_mantel_df,</span>
<span id="cb29-231"><a href="#cb29-231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> mean.cor<span class="sc">-</span> sd.cor, <span class="at">ymax =</span> mean.cor <span class="sc">+</span> sd.cor), <span class="at">fill =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb29-232"><a href="#cb29-232" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)[<span class="dv">7</span>], <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb29-233"><a href="#cb29-233" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="fu">viridis</span>(<span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)[<span class="dv">7</span>], <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb29-234"><a href="#cb29-234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.025</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb29-235"><a href="#cb29-235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb29-236"><a href="#cb29-236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Pairwise geographic distance (km)"</span>, <span class="at">y =</span> <span class="st">"Correlation coefficient"</span>)</span>
<span id="cb29-237"><a href="#cb29-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-238"><a href="#cb29-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-239"><a href="#cb29-239" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"./output/interpolated_mantel_correlogram.png"</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb29-240"><a href="#cb29-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-241"><a href="#cb29-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-242"><a href="#cb29-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-243"><a href="#cb29-243" aria-hidden="true" tabindex="-1"></a><span class="fu"># Simulation </span></span>
<span id="cb29-244"><a href="#cb29-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-245"><a href="#cb29-245" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate data with different patterns of geographic variation in call structure</span></span>
<span id="cb29-246"><a href="#cb29-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-247"><a href="#cb29-247" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>26 localities (10 individuals each) along a longitudinal range</span>
<span id="cb29-248"><a href="#cb29-248" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Simulated patterns following <span class="co">[</span><span class="ot">Podos &amp; Warren (2007)</span><span class="co">](https://d1wqtxts1xzle7.cloudfront.net/53993414/The_Evolution_of_Geographic_Variation_in20170727-7403-7je2az-libre.pdf?1501183774=&amp;response-content-disposition=inline%3B+filename%3DThe_Evolution_of_Geographic_Variation_in.pdf&amp;Expires=1689718560&amp;Signature=c9HxG2TqaqonkjDKlotzx1jrLJl25sX1V2Jj0DpDFTtDNsSi7ykNv~Ii4XFFe-yEh4fUF6HX0MYzT9ImbUJykmwIJXumf8VELyHp5tj5QYjR9FmpCftHXf1JdwBh-vCm2zaQ2VOh~iaHcMqTqjnDQR1W3FMQDU1dVeduLpkSma~8eLQ15e-SAHPYVwvSu-R1a2Q9KDibQyq84MbEFbLgbz9T3eBxZpsUAnxrGUrlHWo9CtbBEMtORbh9id4KG-RaAVyA38v4FtS8qofXX9zpcZNQILVGkhIwXeCbYkRVBbC9w5OieTVvIUQBXxEwZltgQ~ZWzbkzI1~wmHRnkbhYzQ__&amp;Key-Pair-Id=APKAJLOHF5GGSLRBV4ZA)</span></span>
<span id="cb29-249"><a href="#cb29-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-250"><a href="#cb29-250" aria-hidden="true" tabindex="-1"></a><span class="al">![Figure from Podos &amp; Warren (2007)](podos_warren_fig_3.png)</span></span>
<span id="cb29-251"><a href="#cb29-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-252"><a href="#cb29-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap="Geographic location of individuals/localities in the simulated data set. Letters highlight locality ids", out.width="%100"}</span></span>
<span id="cb29-253"><a href="#cb29-253" aria-hidden="true" tabindex="-1"></a><span class="co"># seed to make it reproducible</span></span>
<span id="cb29-254"><a href="#cb29-254" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-255"><a href="#cb29-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-256"><a href="#cb29-256" aria-hidden="true" tabindex="-1"></a><span class="co"># number of groups</span></span>
<span id="cb29-257"><a href="#cb29-257" aria-hidden="true" tabindex="-1"></a>n_locality <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb29-258"><a href="#cb29-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-259"><a href="#cb29-259" aria-hidden="true" tabindex="-1"></a><span class="co"># number of individuals per group</span></span>
<span id="cb29-260"><a href="#cb29-260" aria-hidden="true" tabindex="-1"></a>n_indiv <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb29-261"><a href="#cb29-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-262"><a href="#cb29-262" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate geographic coordinates along a gradient</span></span>
<span id="cb29-263"><a href="#cb29-263" aria-hidden="true" tabindex="-1"></a>lon <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_locality, <span class="at">each =</span> n_indiv) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span> n_locality, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb29-264"><a href="#cb29-264" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span> n_locality, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb29-265"><a href="#cb29-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-266"><a href="#cb29-266" aria-hidden="true" tabindex="-1"></a><span class="co"># create locality labels</span></span>
<span id="cb29-267"><a href="#cb29-267" aria-hidden="true" tabindex="-1"></a>localities <span class="ot">&lt;-</span> <span class="fu">sample</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span>n_locality])</span>
<span id="cb29-268"><a href="#cb29-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-269"><a href="#cb29-269" aria-hidden="true" tabindex="-1"></a><span class="co"># put all together in a data frame</span></span>
<span id="cb29-270"><a href="#cb29-270" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">locality =</span> <span class="fu">rep</span>(localities, <span class="at">each =</span> n_indiv), lat, lon, <span class="at">color =</span> <span class="fu">viridis</span>(n_locality)[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_locality, <span class="at">each =</span> n_indiv)])</span>
<span id="cb29-271"><a href="#cb29-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-272"><a href="#cb29-272" aria-hidden="true" tabindex="-1"></a><span class="co"># plot localities along longitude</span></span>
<span id="cb29-273"><a href="#cb29-273" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data[, <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>)], <span class="at">col =</span> data<span class="sc">$</span>color, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">1.8</span>, <span class="at">ylim =</span> <span class="fu">range</span>(data<span class="sc">$</span>lat) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">2</span>, .<span class="dv">2</span>))</span>
<span id="cb29-274"><a href="#cb29-274" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">tapply</span>(data<span class="sc">$</span>lon, data<span class="sc">$</span>locality, mean), <span class="at">y =</span> <span class="fu">rep</span>(<span class="fl">0.3</span>, n_locality), <span class="at">labels =</span> localities, <span class="at">cex =</span> <span class="fl">2.5</span>)</span>
<span id="cb29-275"><a href="#cb29-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-276"><a href="#cb29-276" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span> <span class="sc">-</span> <span class="fl">0.5</span>)</span>
<span id="cb29-277"><a href="#cb29-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-278"><a href="#cb29-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-279"><a href="#cb29-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-280"><a href="#cb29-280" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulate acoustic variation:</span></span>
<span id="cb29-281"><a href="#cb29-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-282"><a href="#cb29-282" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Clinal: acoustic structure vector increases with longitude</span>
<span id="cb29-283"><a href="#cb29-283" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Dialect-type: acoustic structure vector similar within a locality but varies randomly between neighnoring localities</span>
<span id="cb29-284"><a href="#cb29-284" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Dialect-clinal: Combined clinal and dialect variation, dialect that vary with a geographic trend</span>
<span id="cb29-285"><a href="#cb29-285" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Random: acoustic structure vector varies randomly between individuals regardless of locality or longitude</span>
<span id="cb29-286"><a href="#cb29-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-287"><a href="#cb29-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.cap="Types of vocal geographic variation that were simulated", fig.height=10}</span></span>
<span id="cb29-288"><a href="#cb29-288" aria-hidden="true" tabindex="-1"></a><span class="co"># seed to make it reproducible</span></span>
<span id="cb29-289"><a href="#cb29-289" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-290"><a href="#cb29-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-291"><a href="#cb29-291" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate acoustic structure vector </span></span>
<span id="cb29-292"><a href="#cb29-292" aria-hidden="true" tabindex="-1"></a><span class="co"># clinal variation</span></span>
<span id="cb29-293"><a href="#cb29-293" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>clinal <span class="ot">&lt;-</span> data<span class="sc">$</span>lon <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(data), <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb29-294"><a href="#cb29-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-295"><a href="#cb29-295" aria-hidden="true" tabindex="-1"></a><span class="co"># dialect type variation</span></span>
<span id="cb29-296"><a href="#cb29-296" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>dialect <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data<span class="sc">$</span>locality)) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span> n_locality, <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb29-297"><a href="#cb29-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-298"><a href="#cb29-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-299"><a href="#cb29-299" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>dialect_clinal <span class="ot">&lt;-</span> data<span class="sc">$</span>clinal <span class="sc">*</span> data<span class="sc">$</span>dialect</span>
<span id="cb29-300"><a href="#cb29-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-301"><a href="#cb29-301" aria-hidden="true" tabindex="-1"></a><span class="co"># random variation</span></span>
<span id="cb29-302"><a href="#cb29-302" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(data), <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb29-303"><a href="#cb29-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-304"><a href="#cb29-304" aria-hidden="true" tabindex="-1"></a><span class="co"># sort so lines look good in plot </span></span>
<span id="cb29-305"><a href="#cb29-305" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[<span class="fu">order</span>(data<span class="sc">$</span>lon), ]</span>
<span id="cb29-306"><a href="#cb29-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-307"><a href="#cb29-307" aria-hidden="true" tabindex="-1"></a><span class="co"># plot </span></span>
<span id="cb29-308"><a href="#cb29-308" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))</span>
<span id="cb29-309"><a href="#cb29-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-310"><a href="#cb29-310" aria-hidden="true" tabindex="-1"></a><span class="co"># random</span></span>
<span id="cb29-311"><a href="#cb29-311" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)), data<span class="sc">$</span>random, <span class="at">type=</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Random"</span>, <span class="at">xlab =</span> <span class="st">"Longitude"</span>, <span class="at">ylab =</span> <span class="st">"Call structure"</span>, <span class="at">col =</span> <span class="st">"#3E4A89FF"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb29-312"><a href="#cb29-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-313"><a href="#cb29-313" aria-hidden="true" tabindex="-1"></a><span class="co"># dialect</span></span>
<span id="cb29-314"><a href="#cb29-314" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)), data<span class="sc">$</span>dialect, <span class="at">type=</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Dialect"</span>, <span class="at">xlab =</span> <span class="st">"Longitude"</span>, <span class="at">ylab =</span> <span class="st">"Call structure"</span>, <span class="at">col =</span> <span class="st">"#3E4A89FF"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb29-315"><a href="#cb29-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-316"><a href="#cb29-316" aria-hidden="true" tabindex="-1"></a><span class="co"># dialect clinal</span></span>
<span id="cb29-317"><a href="#cb29-317" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)), data<span class="sc">$</span>dialect_clinal, <span class="at">type=</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Dialect * Clinal"</span>, <span class="at">xlab =</span> <span class="st">"Longitude"</span>, <span class="at">ylab =</span> <span class="st">"Call structure"</span>, <span class="at">col =</span> <span class="st">"#3E4A89FF"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb29-318"><a href="#cb29-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-319"><a href="#cb29-319" aria-hidden="true" tabindex="-1"></a><span class="co"># clinal</span></span>
<span id="cb29-320"><a href="#cb29-320" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)), data<span class="sc">$</span>clinal, <span class="at">type=</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Clinal"</span>, <span class="at">xlab =</span> <span class="st">"Longitude"</span>, <span class="at">ylab =</span> <span class="st">"Call structure"</span>, <span class="at">col =</span> <span class="st">"#3E4A89FF"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb29-321"><a href="#cb29-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-322"><a href="#cb29-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-323"><a href="#cb29-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-324"><a href="#cb29-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-325"><a href="#cb29-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-326"><a href="#cb29-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-327"><a href="#cb29-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stats on simulated data</span></span>
<span id="cb29-328"><a href="#cb29-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-329"><a href="#cb29-329" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>Model:   </span>
<span id="cb29-330"><a href="#cb29-330" aria-hidden="true" tabindex="-1"></a> \begin{align*}</span>
<span id="cb29-331"><a href="#cb29-331" aria-hidden="true" tabindex="-1"></a> Acoustic\ dissimilarity &amp;\sim locality + geographic\ distance</span>
<span id="cb29-332"><a href="#cb29-332" aria-hidden="true" tabindex="-1"></a> \end{align*}</span>
<span id="cb29-333"><a href="#cb29-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-334"><a href="#cb29-334" aria-hidden="true" tabindex="-1"></a>Predict acoustic structure based on geographic distance and locality membership using multiple Regression on distance matrices</span>
<span id="cb29-335"><a href="#cb29-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-336"><a href="#cb29-336" aria-hidden="true" tabindex="-1"></a>Data is z-transformed so all predictors have similar variance and effect sizes are comparable.</span>
<span id="cb29-337"><a href="#cb29-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-338"><a href="#cb29-338" aria-hidden="true" tabindex="-1"></a>Variance for each predictor:</span>
<span id="cb29-341"><a href="#cb29-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-342"><a href="#cb29-342" aria-hidden="true" tabindex="-1"></a><span class="co"># create distance matrices</span></span>
<span id="cb29-343"><a href="#cb29-343" aria-hidden="true" tabindex="-1"></a>call_member_binary <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(PhenotypeSpace<span class="sc">::</span><span class="fu">binary_triangular_matrix</span>(<span class="at">group =</span> data<span class="sc">$</span>locality))</span>
<span id="cb29-344"><a href="#cb29-344" aria-hidden="true" tabindex="-1"></a>clinal_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>clinal)</span>
<span id="cb29-345"><a href="#cb29-345" aria-hidden="true" tabindex="-1"></a>dialect_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>dialect)</span>
<span id="cb29-346"><a href="#cb29-346" aria-hidden="true" tabindex="-1"></a>dialect_clinal_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>dialect_clinal)</span>
<span id="cb29-347"><a href="#cb29-347" aria-hidden="true" tabindex="-1"></a>random_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>random)</span>
<span id="cb29-348"><a href="#cb29-348" aria-hidden="true" tabindex="-1"></a>geo_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data[, <span class="fu">c</span>(<span class="st">"lat"</span>, <span class="st">"lon"</span>)])</span>
<span id="cb29-349"><a href="#cb29-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-350"><a href="#cb29-350" aria-hidden="true" tabindex="-1"></a><span class="co"># regression models</span></span>
<span id="cb29-351"><a href="#cb29-351" aria-hidden="true" tabindex="-1"></a><span class="co"># set data format</span></span>
<span id="cb29-352"><a href="#cb29-352" aria-hidden="true" tabindex="-1"></a>rect_var <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">clinal_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(clinal_dist)), <span class="at">dialect_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(dialect_dist)), <span class="at">dialect_clinal_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(dialect_clinal_dist)), <span class="at">random_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(random_dist)), <span class="at">geo_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(geo_dist)), <span class="at">call_member_binary =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(call_member_binary)))</span>
<span id="cb29-353"><a href="#cb29-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-354"><a href="#cb29-354" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(rect_var,<span class="dv">2</span>, var)</span>
<span id="cb29-355"><a href="#cb29-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-356"><a href="#cb29-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-357"><a href="#cb29-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-358"><a href="#cb29-358" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dialect-type variation model</span></span>
<span id="cb29-361"><a href="#cb29-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-362"><a href="#cb29-362" aria-hidden="true" tabindex="-1"></a><span class="co"># model predicting dialect variation</span></span>
<span id="cb29-363"><a href="#cb29-363" aria-hidden="true" tabindex="-1"></a>(mod_dialect <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> dialect_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary, <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"dialect_dist"</span>, <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]))</span>
<span id="cb29-364"><a href="#cb29-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-365"><a href="#cb29-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-366"><a href="#cb29-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-367"><a href="#cb29-367" aria-hidden="true" tabindex="-1"></a><span class="fu">### Clinal variation model</span></span>
<span id="cb29-370"><a href="#cb29-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-371"><a href="#cb29-371" aria-hidden="true" tabindex="-1"></a><span class="co"># model predicting clinal variation</span></span>
<span id="cb29-372"><a href="#cb29-372" aria-hidden="true" tabindex="-1"></a>(mod_clinal <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> clinal_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary, <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"clinal_dist"</span>, <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]))</span>
<span id="cb29-373"><a href="#cb29-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-374"><a href="#cb29-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-375"><a href="#cb29-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-376"><a href="#cb29-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-377"><a href="#cb29-377" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dialect-clinal variation model</span></span>
<span id="cb29-380"><a href="#cb29-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-381"><a href="#cb29-381" aria-hidden="true" tabindex="-1"></a><span class="co"># model predicting clinal variation</span></span>
<span id="cb29-382"><a href="#cb29-382" aria-hidden="true" tabindex="-1"></a>(mod_dialect_clinal <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> dialect_clinal_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary, <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"dialect_clinal_dist"</span>, <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]))</span>
<span id="cb29-383"><a href="#cb29-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-384"><a href="#cb29-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-385"><a href="#cb29-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-386"><a href="#cb29-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-387"><a href="#cb29-387" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random variation model</span></span>
<span id="cb29-390"><a href="#cb29-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-391"><a href="#cb29-391" aria-hidden="true" tabindex="-1"></a><span class="co"># model predicting random variation</span></span>
<span id="cb29-392"><a href="#cb29-392" aria-hidden="true" tabindex="-1"></a>(mod_random <span class="ot">&lt;-</span> <span class="fu">MRM2</span>(<span class="at">formula =</span> random_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary, <span class="at">nperm =</span> <span class="dv">1000</span>, <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"random_dist"</span>, <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]))</span>
<span id="cb29-393"><a href="#cb29-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-394"><a href="#cb29-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-395"><a href="#cb29-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-396"><a href="#cb29-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-397"><a href="#cb29-397" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combined results</span></span>
<span id="cb29-398"><a href="#cb29-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-401"><a href="#cb29-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-402"><a href="#cb29-402" aria-hidden="true" tabindex="-1"></a>mods <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mod_clinal =</span> mod_clinal, <span class="at">mod_dialect =</span> mod_dialect, <span class="at">mod_dialect_clinal =</span> mod_dialect_clinal, <span class="at">mod_random =</span> mod_random)</span>
<span id="cb29-403"><a href="#cb29-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-404"><a href="#cb29-404" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mods) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Clinal"</span>, <span class="st">"Dialect"</span>, <span class="st">"Dialect * clinal"</span>, <span class="st">"Random"</span>)</span>
<span id="cb29-405"><a href="#cb29-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-406"><a href="#cb29-406" aria-hidden="true" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">seq_along</span>(mods), <span class="cf">function</span>(x) {</span>
<span id="cb29-407"><a href="#cb29-407" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mods[[x]]<span class="sc">$</span>coef[<span class="sc">-</span><span class="dv">1</span>, ])</span>
<span id="cb29-408"><a href="#cb29-408" aria-hidden="true" tabindex="-1"></a>    Y<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> Y[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">max</span>(Y[, <span class="dv">1</span>])</span>
<span id="cb29-409"><a href="#cb29-409" aria-hidden="true" tabindex="-1"></a>    Y<span class="sc">$</span>mod <span class="ot">&lt;-</span> <span class="fu">names</span>(mods)[x]</span>
<span id="cb29-410"><a href="#cb29-410" aria-hidden="true" tabindex="-1"></a>    Y<span class="sc">$</span>predictor <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Y)</span>
<span id="cb29-411"><a href="#cb29-411" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(Y) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"coef"</span>, <span class="st">"p"</span>, <span class="st">"rel_coef"</span>, <span class="st">"model"</span>, <span class="st">"predictor"</span>)</span>
<span id="cb29-412"><a href="#cb29-412" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(Y)</span>
<span id="cb29-413"><a href="#cb29-413" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb29-414"><a href="#cb29-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-415"><a href="#cb29-415" aria-hidden="true" tabindex="-1"></a>estimates<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(estimates<span class="sc">$</span>p <span class="sc">&lt;</span> <span class="fl">0.05</span>, estimates<span class="sc">$</span>rel_coef,</span>
<span id="cb29-416"><a href="#cb29-416" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>)</span>
<span id="cb29-417"><a href="#cb29-417" aria-hidden="true" tabindex="-1"></a>estimates<span class="sc">$</span>signif <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(estimates<span class="sc">$</span>p <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"p &lt; 0.05"</span>, <span class="st">"p &gt;= 0.05"</span>)</span>
<span id="cb29-418"><a href="#cb29-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-419"><a href="#cb29-419" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(estimates, <span class="fu">aes</span>(<span class="at">x =</span> predictor, <span class="at">y =</span> model, <span class="at">fill =</span> rel_coef)) <span class="sc">+</span></span>
<span id="cb29-420"><a href="#cb29-420" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_equal</span>() <span class="sc">+</span> <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="fu">viridis</span>(<span class="dv">10</span>)[<span class="dv">3</span>],</span>
<span id="cb29-421"><a href="#cb29-421" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="fu">viridis</span>(<span class="dv">10</span>)[<span class="dv">7</span>], <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(coef,</span>
<span id="cb29-422"><a href="#cb29-422" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>), <span class="at">color =</span> signif)) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>,</span>
<span id="cb29-423"><a href="#cb29-423" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gray"</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">"P value"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb29-424"><a href="#cb29-424" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">angle =</span> <span class="dv">30</span>,</span>
<span id="cb29-425"><a href="#cb29-425" aria-hidden="true" tabindex="-1"></a>        <span class="at">vjust =</span> <span class="fl">0.8</span>, <span class="at">hjust =</span> <span class="fl">0.8</span>))</span>
<span id="cb29-426"><a href="#cb29-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-427"><a href="#cb29-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-428"><a href="#cb29-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-429"><a href="#cb29-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-430"><a href="#cb29-430" aria-hidden="true" tabindex="-1"></a><span class="fu">## Replicate simulation 100 times</span></span>
<span id="cb29-431"><a href="#cb29-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-432"><a href="#cb29-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb29-433"><a href="#cb29-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-434"><a href="#cb29-434" aria-hidden="true" tabindex="-1"></a>rep_models <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>, <span class="at">expr =</span> {</span>
<span id="cb29-435"><a href="#cb29-435" aria-hidden="true" tabindex="-1"></a>    <span class="co"># number of groups</span></span>
<span id="cb29-436"><a href="#cb29-436" aria-hidden="true" tabindex="-1"></a>    n_locality <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb29-437"><a href="#cb29-437" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-438"><a href="#cb29-438" aria-hidden="true" tabindex="-1"></a>    <span class="co"># number of individuals per group</span></span>
<span id="cb29-439"><a href="#cb29-439" aria-hidden="true" tabindex="-1"></a>    n_indiv <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb29-440"><a href="#cb29-440" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-441"><a href="#cb29-441" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulate geographic coordinates along a gradient</span></span>
<span id="cb29-442"><a href="#cb29-442" aria-hidden="true" tabindex="-1"></a>    lon <span class="ot">&lt;-</span></span>
<span id="cb29-443"><a href="#cb29-443" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_locality, <span class="at">each =</span> n_indiv) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span> n_locality, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb29-444"><a href="#cb29-444" aria-hidden="true" tabindex="-1"></a>    lat <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span> n_locality, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb29-445"><a href="#cb29-445" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-446"><a href="#cb29-446" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create locality labels</span></span>
<span id="cb29-447"><a href="#cb29-447" aria-hidden="true" tabindex="-1"></a>    localities <span class="ot">&lt;-</span> <span class="fu">sample</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span>n_locality])</span>
<span id="cb29-448"><a href="#cb29-448" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-449"><a href="#cb29-449" aria-hidden="true" tabindex="-1"></a>    <span class="co"># put all together in a data frame</span></span>
<span id="cb29-450"><a href="#cb29-450" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span></span>
<span id="cb29-451"><a href="#cb29-451" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(</span>
<span id="cb29-452"><a href="#cb29-452" aria-hidden="true" tabindex="-1"></a>            <span class="at">locality =</span> <span class="fu">rep</span>(localities, <span class="at">each =</span> n_indiv),</span>
<span id="cb29-453"><a href="#cb29-453" aria-hidden="true" tabindex="-1"></a>            lat,</span>
<span id="cb29-454"><a href="#cb29-454" aria-hidden="true" tabindex="-1"></a>            lon,</span>
<span id="cb29-455"><a href="#cb29-455" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">viridis</span>(n_locality)[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_locality, <span class="at">each =</span> n_indiv)]</span>
<span id="cb29-456"><a href="#cb29-456" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-457"><a href="#cb29-457" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-458"><a href="#cb29-458" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulate acoustic structure vector</span></span>
<span id="cb29-459"><a href="#cb29-459" aria-hidden="true" tabindex="-1"></a>    <span class="co"># clinal variation</span></span>
<span id="cb29-460"><a href="#cb29-460" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>clinal <span class="ot">&lt;-</span> data<span class="sc">$</span>lon <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(data), <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb29-461"><a href="#cb29-461" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-462"><a href="#cb29-462" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dialect type variation</span></span>
<span id="cb29-463"><a href="#cb29-463" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>dialect <span class="ot">&lt;-</span></span>
<span id="cb29-464"><a href="#cb29-464" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(data<span class="sc">$</span>locality)) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_indiv <span class="sc">*</span> n_locality, <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb29-465"><a href="#cb29-465" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-466"><a href="#cb29-466" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-467"><a href="#cb29-467" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>dialect_clinal <span class="ot">&lt;-</span> data<span class="sc">$</span>clinal <span class="sc">*</span> data<span class="sc">$</span>dialect</span>
<span id="cb29-468"><a href="#cb29-468" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-469"><a href="#cb29-469" aria-hidden="true" tabindex="-1"></a>    <span class="co"># random variation</span></span>
<span id="cb29-470"><a href="#cb29-470" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(data), <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb29-471"><a href="#cb29-471" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-472"><a href="#cb29-472" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sort so lines look good in plot</span></span>
<span id="cb29-473"><a href="#cb29-473" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data[<span class="fu">order</span>(data<span class="sc">$</span>lon),]</span>
<span id="cb29-474"><a href="#cb29-474" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-475"><a href="#cb29-475" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create distance matrices</span></span>
<span id="cb29-476"><a href="#cb29-476" aria-hidden="true" tabindex="-1"></a>    call_member_binary <span class="ot">&lt;-</span></span>
<span id="cb29-477"><a href="#cb29-477" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.dist</span>(PhenotypeSpace<span class="sc">::</span><span class="fu">binary_triangular_matrix</span>(<span class="at">group =</span> data<span class="sc">$</span>locality))</span>
<span id="cb29-478"><a href="#cb29-478" aria-hidden="true" tabindex="-1"></a>    clinal_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>clinal)</span>
<span id="cb29-479"><a href="#cb29-479" aria-hidden="true" tabindex="-1"></a>    dialect_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>dialect)</span>
<span id="cb29-480"><a href="#cb29-480" aria-hidden="true" tabindex="-1"></a>    dialect_clinal_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>dialect_clinal)</span>
<span id="cb29-481"><a href="#cb29-481" aria-hidden="true" tabindex="-1"></a>    random_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data<span class="sc">$</span>random)</span>
<span id="cb29-482"><a href="#cb29-482" aria-hidden="true" tabindex="-1"></a>    geo_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data[, <span class="fu">c</span>(<span class="st">"lat"</span>, <span class="st">"lon"</span>)])</span>
<span id="cb29-483"><a href="#cb29-483" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-484"><a href="#cb29-484" aria-hidden="true" tabindex="-1"></a>    <span class="co"># regression models</span></span>
<span id="cb29-485"><a href="#cb29-485" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set data format</span></span>
<span id="cb29-486"><a href="#cb29-486" aria-hidden="true" tabindex="-1"></a>    rect_var <span class="ot">&lt;-</span></span>
<span id="cb29-487"><a href="#cb29-487" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(</span>
<span id="cb29-488"><a href="#cb29-488" aria-hidden="true" tabindex="-1"></a>            <span class="at">clinal_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(clinal_dist)),</span>
<span id="cb29-489"><a href="#cb29-489" aria-hidden="true" tabindex="-1"></a>            <span class="at">dialect_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(dialect_dist)),</span>
<span id="cb29-490"><a href="#cb29-490" aria-hidden="true" tabindex="-1"></a>            <span class="at">dialect_clinal_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(dialect_clinal_dist)),</span>
<span id="cb29-491"><a href="#cb29-491" aria-hidden="true" tabindex="-1"></a>            <span class="at">random_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(random_dist)),</span>
<span id="cb29-492"><a href="#cb29-492" aria-hidden="true" tabindex="-1"></a>            <span class="at">geo_dist =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(geo_dist)),</span>
<span id="cb29-493"><a href="#cb29-493" aria-hidden="true" tabindex="-1"></a>            <span class="at">call_member_binary =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(call_member_binary))</span>
<span id="cb29-494"><a href="#cb29-494" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-495"><a href="#cb29-495" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-496"><a href="#cb29-496" aria-hidden="true" tabindex="-1"></a>    <span class="co"># model predicting dialect variation</span></span>
<span id="cb29-497"><a href="#cb29-497" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb29-498"><a href="#cb29-498" aria-hidden="true" tabindex="-1"></a>        mod_dialect <span class="ot">&lt;-</span></span>
<span id="cb29-499"><a href="#cb29-499" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MRM2</span>(</span>
<span id="cb29-500"><a href="#cb29-500" aria-hidden="true" tabindex="-1"></a>                <span class="at">formula =</span> dialect_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary,</span>
<span id="cb29-501"><a href="#cb29-501" aria-hidden="true" tabindex="-1"></a>                <span class="at">nperm =</span> <span class="dv">1000</span>,</span>
<span id="cb29-502"><a href="#cb29-502" aria-hidden="true" tabindex="-1"></a>                <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"dialect_dist"</span>, <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]</span>
<span id="cb29-503"><a href="#cb29-503" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb29-504"><a href="#cb29-504" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-505"><a href="#cb29-505" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-506"><a href="#cb29-506" aria-hidden="true" tabindex="-1"></a>    <span class="co"># model predicting clinal variation</span></span>
<span id="cb29-507"><a href="#cb29-507" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb29-508"><a href="#cb29-508" aria-hidden="true" tabindex="-1"></a>        mod_clinal <span class="ot">&lt;-</span></span>
<span id="cb29-509"><a href="#cb29-509" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MRM2</span>(</span>
<span id="cb29-510"><a href="#cb29-510" aria-hidden="true" tabindex="-1"></a>                <span class="at">formula =</span> clinal_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary,</span>
<span id="cb29-511"><a href="#cb29-511" aria-hidden="true" tabindex="-1"></a>                <span class="at">nperm =</span> <span class="dv">1000</span>,</span>
<span id="cb29-512"><a href="#cb29-512" aria-hidden="true" tabindex="-1"></a>                <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"clinal_dist"</span>, <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]</span>
<span id="cb29-513"><a href="#cb29-513" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb29-514"><a href="#cb29-514" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-515"><a href="#cb29-515" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-516"><a href="#cb29-516" aria-hidden="true" tabindex="-1"></a>    <span class="co"># model predicting clinal variation</span></span>
<span id="cb29-517"><a href="#cb29-517" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb29-518"><a href="#cb29-518" aria-hidden="true" tabindex="-1"></a>        mod_dialect_clinal <span class="ot">&lt;-</span></span>
<span id="cb29-519"><a href="#cb29-519" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MRM2</span>(</span>
<span id="cb29-520"><a href="#cb29-520" aria-hidden="true" tabindex="-1"></a>                <span class="at">formula =</span> dialect_clinal_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary,</span>
<span id="cb29-521"><a href="#cb29-521" aria-hidden="true" tabindex="-1"></a>                <span class="at">nperm =</span> <span class="dv">1000</span>,</span>
<span id="cb29-522"><a href="#cb29-522" aria-hidden="true" tabindex="-1"></a>                <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"dialect_clinal_dist"</span>, <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]</span>
<span id="cb29-523"><a href="#cb29-523" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb29-524"><a href="#cb29-524" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-525"><a href="#cb29-525" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-526"><a href="#cb29-526" aria-hidden="true" tabindex="-1"></a>    <span class="co"># model predicting random variation</span></span>
<span id="cb29-527"><a href="#cb29-527" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb29-528"><a href="#cb29-528" aria-hidden="true" tabindex="-1"></a>        mod_random <span class="ot">&lt;-</span></span>
<span id="cb29-529"><a href="#cb29-529" aria-hidden="true" tabindex="-1"></a>            <span class="fu">MRM2</span>(</span>
<span id="cb29-530"><a href="#cb29-530" aria-hidden="true" tabindex="-1"></a>                <span class="at">formula =</span> random_dist <span class="sc">~</span> geo_dist <span class="sc">+</span> call_member_binary,</span>
<span id="cb29-531"><a href="#cb29-531" aria-hidden="true" tabindex="-1"></a>                <span class="at">nperm =</span> <span class="dv">1000</span>,</span>
<span id="cb29-532"><a href="#cb29-532" aria-hidden="true" tabindex="-1"></a>                <span class="at">mat =</span> rect_var[, <span class="fu">c</span>(<span class="st">"random_dist"</span>, <span class="st">"geo_dist"</span>, <span class="st">"call_member_binary"</span>)]</span>
<span id="cb29-533"><a href="#cb29-533" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb29-534"><a href="#cb29-534" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-535"><a href="#cb29-535" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-536"><a href="#cb29-536" aria-hidden="true" tabindex="-1"></a>    mods <span class="ot">&lt;-</span></span>
<span id="cb29-537"><a href="#cb29-537" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb29-538"><a href="#cb29-538" aria-hidden="true" tabindex="-1"></a>            <span class="at">mod_clinal =</span> mod_clinal,</span>
<span id="cb29-539"><a href="#cb29-539" aria-hidden="true" tabindex="-1"></a>            <span class="at">mod_dialect =</span> mod_dialect,</span>
<span id="cb29-540"><a href="#cb29-540" aria-hidden="true" tabindex="-1"></a>            <span class="at">mod_dialect_clinal =</span> mod_dialect_clinal,</span>
<span id="cb29-541"><a href="#cb29-541" aria-hidden="true" tabindex="-1"></a>            <span class="at">mod_random =</span> mod_random</span>
<span id="cb29-542"><a href="#cb29-542" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-543"><a href="#cb29-543" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-544"><a href="#cb29-544" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(mods) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Clinal"</span>, <span class="st">"Dialect"</span>, <span class="st">"Dialect * clinal"</span>, <span class="st">"Random"</span>)</span>
<span id="cb29-545"><a href="#cb29-545" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-546"><a href="#cb29-546" aria-hidden="true" tabindex="-1"></a>    estimates <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">seq_along</span>(mods), <span class="cf">function</span>(x) {</span>
<span id="cb29-547"><a href="#cb29-547" aria-hidden="true" tabindex="-1"></a>        Y <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mods[[x]]<span class="sc">$</span>coef[<span class="sc">-</span><span class="dv">1</span>,])</span>
<span id="cb29-548"><a href="#cb29-548" aria-hidden="true" tabindex="-1"></a>        Y<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> Y[, <span class="dv">1</span>] <span class="sc">/</span> <span class="fu">max</span>(Y[, <span class="dv">1</span>])</span>
<span id="cb29-549"><a href="#cb29-549" aria-hidden="true" tabindex="-1"></a>        Y<span class="sc">$</span>mod <span class="ot">&lt;-</span> <span class="fu">names</span>(mods)[x]</span>
<span id="cb29-550"><a href="#cb29-550" aria-hidden="true" tabindex="-1"></a>        Y<span class="sc">$</span>predictor <span class="ot">&lt;-</span> <span class="fu">rownames</span>(Y)</span>
<span id="cb29-551"><a href="#cb29-551" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(Y) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"coef"</span>, <span class="st">"p"</span>, <span class="st">"rel_coef"</span>, <span class="st">"model"</span>, <span class="st">"predictor"</span>)</span>
<span id="cb29-552"><a href="#cb29-552" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(Y)</span>
<span id="cb29-553"><a href="#cb29-553" aria-hidden="true" tabindex="-1"></a>    }))</span>
<span id="cb29-554"><a href="#cb29-554" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-555"><a href="#cb29-555" aria-hidden="true" tabindex="-1"></a>    estimates</span>
<span id="cb29-556"><a href="#cb29-556" aria-hidden="true" tabindex="-1"></a>}, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-557"><a href="#cb29-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-558"><a href="#cb29-558" aria-hidden="true" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, <span class="fu">lapply</span>(rep_models, <span class="cf">function</span>(x)</span>
<span id="cb29-559"><a href="#cb29-559" aria-hidden="true" tabindex="-1"></a>    x[, <span class="dv">1</span>]))</span>
<span id="cb29-560"><a href="#cb29-560" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, <span class="fu">lapply</span>(rep_models, <span class="cf">function</span>(x)</span>
<span id="cb29-561"><a href="#cb29-561" aria-hidden="true" tabindex="-1"></a>    x[, <span class="dv">2</span>]))</span>
<span id="cb29-562"><a href="#cb29-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-563"><a href="#cb29-563" aria-hidden="true" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> rep_models[[<span class="dv">1</span>]]</span>
<span id="cb29-564"><a href="#cb29-564" aria-hidden="true" tabindex="-1"></a>estimates<span class="sc">$</span>coef <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(coeffs)</span>
<span id="cb29-565"><a href="#cb29-565" aria-hidden="true" tabindex="-1"></a>estimates<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(ps)</span>
<span id="cb29-566"><a href="#cb29-566" aria-hidden="true" tabindex="-1"></a>estimates<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(ps)</span>
<span id="cb29-567"><a href="#cb29-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-568"><a href="#cb29-568" aria-hidden="true" tabindex="-1"></a>estimates<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> estimates[, <span class="dv">1</span>] <span class="sc">/</span> <span class="fu">max</span>(estimates[, <span class="dv">1</span>])</span>
<span id="cb29-569"><a href="#cb29-569" aria-hidden="true" tabindex="-1"></a>estimates<span class="sc">$</span>rel_coef <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(estimates<span class="sc">$</span>p <span class="sc">&lt;</span> <span class="fl">0.05</span>, estimates<span class="sc">$</span>rel_coef,</span>
<span id="cb29-570"><a href="#cb29-570" aria-hidden="true" tabindex="-1"></a>                             <span class="dv">0</span>)</span>
<span id="cb29-571"><a href="#cb29-571" aria-hidden="true" tabindex="-1"></a>estimates<span class="sc">$</span>signif <span class="ot">&lt;-</span></span>
<span id="cb29-572"><a href="#cb29-572" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(estimates<span class="sc">$</span>p <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"p &lt; 0.05"</span>, <span class="st">"p &gt;= 0.05"</span>)</span>
<span id="cb29-573"><a href="#cb29-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-574"><a href="#cb29-574" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(estimates,</span>
<span id="cb29-575"><a href="#cb29-575" aria-hidden="true" tabindex="-1"></a>        <span class="st">"./data/processed/estimates_for_replicated_simulation_dialects.RDS"</span>)</span>
<span id="cb29-576"><a href="#cb29-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-577"><a href="#cb29-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-578"><a href="#cb29-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-579"><a href="#cb29-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-582"><a href="#cb29-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-583"><a href="#cb29-583" aria-hidden="true" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/estimates_for_replicated_simulation_dialects.RDS"</span>)</span>
<span id="cb29-584"><a href="#cb29-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-585"><a href="#cb29-585" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(estimates, <span class="fu">aes</span>(<span class="at">x =</span> predictor, <span class="at">y =</span> model, <span class="at">fill =</span> rel_coef)) <span class="sc">+</span></span>
<span id="cb29-586"><a href="#cb29-586" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">coord_equal</span>() <span class="sc">+</span> <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="fu">viridis</span>(<span class="dv">10</span>)[<span class="dv">3</span>],</span>
<span id="cb29-587"><a href="#cb29-587" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="fu">viridis</span>(<span class="dv">10</span>)[<span class="dv">7</span>], <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(coef,</span>
<span id="cb29-588"><a href="#cb29-588" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>), <span class="at">color =</span> signif)) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>,</span>
<span id="cb29-589"><a href="#cb29-589" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gray"</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">"P value"</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb29-590"><a href="#cb29-590" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">11</span>, <span class="at">angle =</span> <span class="dv">30</span>,</span>
<span id="cb29-591"><a href="#cb29-591" aria-hidden="true" tabindex="-1"></a>        <span class="at">vjust =</span> <span class="fl">0.8</span>, <span class="at">hjust =</span> <span class="fl">0.8</span>))</span>
<span id="cb29-592"><a href="#cb29-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-593"><a href="#cb29-593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-594"><a href="#cb29-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-595"><a href="#cb29-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-596"><a href="#cb29-596" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- light green box --&gt;</span></span>
<span id="cb29-597"><a href="#cb29-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-598"><a href="#cb29-598" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">class</span><span class="ot">=</span><span class="st">"alert alert-success"</span><span class="kw">&gt;</span></span>
<span id="cb29-599"><a href="#cb29-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-600"><a href="#cb29-600" aria-hidden="true" tabindex="-1"></a><span class="fu"># Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb29-601"><a href="#cb29-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-602"><a href="#cb29-602" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Call membership has a stronger effect in dialect-type variation</span>
<span id="cb29-603"><a href="#cb29-603" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Geographic distance has a stronger effect in clinal variation</span>
<span id="cb29-604"><a href="#cb29-604" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Similar effect sizes when both clinal and dialect variation present</span>
<span id="cb29-605"><a href="#cb29-605" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb29-606"><a href="#cb29-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-607"><a href="#cb29-607" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span></span>
<span id="cb29-608"><a href="#cb29-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-609"><a href="#cb29-609" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- '---' adds a gray vertical line --&gt;</span></span>
<span id="cb29-610"><a href="#cb29-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-611"><a href="#cb29-611" aria-hidden="true" tabindex="-1"></a><span class="fu"># Real data analysis</span></span>
<span id="cb29-612"><a href="#cb29-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-613"><a href="#cb29-613" aria-hidden="true" tabindex="-1"></a><span class="fu">## Association between distance call similarity, geographic distance and dialect membership</span></span>
<span id="cb29-614"><a href="#cb29-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-615"><a href="#cb29-615" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Using the function ecodist::MRM() <span class="co">[</span><span class="ot">https://search.r-project.org/CRAN/refmans/ecodist/html/MRM.html</span><span class="co">](https://search.r-project.org/CRAN/refmans/ecodist/html/MRM.html)</span></span>
<span id="cb29-616"><a href="#cb29-616" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Model:   </span>
<span id="cb29-617"><a href="#cb29-617" aria-hidden="true" tabindex="-1"></a> \begin{align*}</span>
<span id="cb29-618"><a href="#cb29-618" aria-hidden="true" tabindex="-1"></a> Acoustic\ dissimilarity &amp;\sim locality + geographic\ distance</span>
<span id="cb29-619"><a href="#cb29-619" aria-hidden="true" tabindex="-1"></a> \end{align*}</span>
<span id="cb29-620"><a href="#cb29-620" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Dialect membership expressed as binary matrix (0 = same dialect, 1 = different dialect)</span>
<span id="cb29-621"><a href="#cb29-621" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Geographic distance expressed in 100 km units</span>
<span id="cb29-622"><a href="#cb29-622" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Effect size expressed as acoustic similarity (changes in cross-correlation coefficients)</span>
<span id="cb29-623"><a href="#cb29-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-624"><a href="#cb29-624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb29-625"><a href="#cb29-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-626"><a href="#cb29-626" aria-hidden="true" tabindex="-1"></a>geo_dists <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"~/Dropbox/Projects/geographic_call_variation_yellow-naped_amazon/data/processed/pairwise_distances.RDS"</span>)</span>
<span id="cb29-627"><a href="#cb29-627" aria-hidden="true" tabindex="-1"></a>sels <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Dropbox/Projects/geographic_call_variation_yellow-naped_amazon/data/raw/ReducedVocalDataYNA.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-628"><a href="#cb29-628" aria-hidden="true" tabindex="-1"></a>xc <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"~/Dropbox/Projects/geographic_call_variation_yellow-naped_amazon/data/processed/SPCC2016_2018_2019.RDS"</span>)</span>
<span id="cb29-629"><a href="#cb29-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-630"><a href="#cb29-630" aria-hidden="true" tabindex="-1"></a>geo_dists <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(geo_dists)</span>
<span id="cb29-631"><a href="#cb29-631" aria-hidden="true" tabindex="-1"></a>call_member_binary <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(PhenotypeSpace<span class="sc">::</span><span class="fu">binary_triangular_matrix</span>(<span class="at">group =</span> sels<span class="sc">$</span>Call_Type))</span>
<span id="cb29-632"><a href="#cb29-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-633"><a href="#cb29-633" aria-hidden="true" tabindex="-1"></a>rect_var <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">acous_sim =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(<span class="dv">1</span><span class="sc">-</span> xc)), <span class="at">geo_dists =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(geo_dists)), <span class="at">call_member_binary =</span> <span class="fu">as.dist</span>(<span class="fu">scale</span>(call_member_binary)))</span>
<span id="cb29-634"><a href="#cb29-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-635"><a href="#cb29-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-636"><a href="#cb29-636" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rect_var) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"acous_distance"</span>, <span class="st">"geo_dists"</span>, <span class="st">"call_member_binary"</span>)</span>
<span id="cb29-637"><a href="#cb29-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-638"><a href="#cb29-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-639"><a href="#cb29-639" aria-hidden="true" tabindex="-1"></a><span class="co"># mod &lt;- MRM2(formula = acous_distance ~ geo_dists + call_member_binary, nperm = 10000, mat = rect_var)</span></span>
<span id="cb29-640"><a href="#cb29-640" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb29-641"><a href="#cb29-641" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(mod, "./data/processed/matrix_correlation_distance_vs_acoustic similarity.RDS")</span></span>
<span id="cb29-642"><a href="#cb29-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-643"><a href="#cb29-643" aria-hidden="true" tabindex="-1"></a>rect_var_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(rect_var)</span>
<span id="cb29-644"><a href="#cb29-644" aria-hidden="true" tabindex="-1"></a>rect_var_df<span class="sc">$</span>membership <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(call_member_binary <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"same"</span>, <span class="st">"different"</span>)</span>
<span id="cb29-645"><a href="#cb29-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-646"><a href="#cb29-646" aria-hidden="true" tabindex="-1"></a>gg_acous <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rect_var_df, <span class="fu">aes</span>(<span class="at">x =</span> geo_dists, <span class="at">y=</span> acous_distance, <span class="at">color =</span> membership)) <span class="sc">+</span></span>
<span id="cb29-647"><a href="#cb29-647" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-648"><a href="#cb29-648" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis_d</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb29-649"><a href="#cb29-649" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb29-650"><a href="#cb29-650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb29-651"><a href="#cb29-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-652"><a href="#cb29-652" aria-hidden="true" tabindex="-1"></a>gg_acous</span>
<span id="cb29-653"><a href="#cb29-653" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(gg_acous, "./output/acoustic_similarity_vs_distance.jpeg")</span></span>
<span id="cb29-654"><a href="#cb29-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-655"><a href="#cb29-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-656"><a href="#cb29-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-657"><a href="#cb29-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb29-658"><a href="#cb29-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-659"><a href="#cb29-659" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/matrix_correlation_distance_vs_acoustic similarity.RDS"</span>)</span>
<span id="cb29-660"><a href="#cb29-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-661"><a href="#cb29-661" aria-hidden="true" tabindex="-1"></a>mod</span>
<span id="cb29-662"><a href="#cb29-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-663"><a href="#cb29-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-664"><a href="#cb29-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-665"><a href="#cb29-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-666"><a href="#cb29-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r DEPRECATED, eval = FALSE}</span></span>
<span id="cb29-667"><a href="#cb29-667" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb29-668"><a href="#cb29-668" aria-hidden="true" tabindex="-1"></a><span class="co"># # Read in .RDS file if you've already saved one</span></span>
<span id="cb29-669"><a href="#cb29-669" aria-hidden="true" tabindex="-1"></a>correl <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/correl_SPCC_100km.RDS"</span>)</span>
<span id="cb29-670"><a href="#cb29-670" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(correl)</span>
<span id="cb29-671"><a href="#cb29-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-672"><a href="#cb29-672" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe from the mantel correlation matrix, remove any existing NA's in the p-values. Create a vector of significance values for the plot and match with  appropriate p-values in the dataframe.</span></span>
<span id="cb29-673"><a href="#cb29-673" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(correl<span class="sc">$</span>mantel.res)</span>
<span id="cb29-674"><a href="#cb29-674" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df1[<span class="sc">!</span><span class="fu">is.na</span>(df1<span class="sc">$</span><span class="st">`</span><span class="at">Pr(corrected)</span><span class="st">`</span>), ]</span>
<span id="cb29-675"><a href="#cb29-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-676"><a href="#cb29-676" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df1<span class="sc">$</span><span class="st">`</span><span class="at">Pr(corrected)</span><span class="st">`</span> <span class="sc">&lt;=</span> <span class="fl">0.05</span>, <span class="st">"sig"</span>, <span class="st">"non-sig"</span>)</span>
<span id="cb29-677"><a href="#cb29-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-678"><a href="#cb29-678" aria-hidden="true" tabindex="-1"></a>p_val <span class="ot">&lt;-</span> df1<span class="sc">$</span><span class="st">`</span><span class="at">Pr(corrected)</span><span class="st">`</span></span>
<span id="cb29-679"><a href="#cb29-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-680"><a href="#cb29-680" aria-hidden="true" tabindex="-1"></a>distance <span class="ot">&lt;-</span> df1<span class="sc">$</span>class.index</span>
<span id="cb29-681"><a href="#cb29-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-682"><a href="#cb29-682" aria-hidden="true" tabindex="-1"></a>corr <span class="ot">&lt;-</span> df1<span class="sc">$</span>Mantel.cor</span>
<span id="cb29-683"><a href="#cb29-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-684"><a href="#cb29-684" aria-hidden="true" tabindex="-1"></a>sig_cat <span class="ot">&lt;-</span> sig</span>
<span id="cb29-685"><a href="#cb29-685" aria-hidden="true" tabindex="-1"></a>sig_cat[sig_cat <span class="sc">==</span> <span class="st">"sig"</span> <span class="sc">&amp;</span> corr <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">"Lower"</span></span>
<span id="cb29-686"><a href="#cb29-686" aria-hidden="true" tabindex="-1"></a>sig_cat[sig_cat <span class="sc">==</span> <span class="st">"sig"</span> <span class="sc">&amp;</span> corr <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">"Higher"</span></span>
<span id="cb29-687"><a href="#cb29-687" aria-hidden="true" tabindex="-1"></a>sig_cat[sig_cat <span class="sc">==</span> <span class="st">"non-sig"</span>] <span class="ot">&lt;-</span> <span class="st">"Neutral"</span></span>
<span id="cb29-688"><a href="#cb29-688" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(sig_cat)</span>
<span id="cb29-689"><a href="#cb29-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-690"><a href="#cb29-690" aria-hidden="true" tabindex="-1"></a>corr_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">distance =</span> distance, <span class="at">corr =</span> corr, <span class="at">p_val =</span> p_val, <span class="at">sig =</span> sig, <span class="at">sig_cat =</span> sig_cat)</span>
<span id="cb29-691"><a href="#cb29-691" aria-hidden="true" tabindex="-1"></a>corr_df<span class="sc">$</span>sig <span class="ot">&lt;-</span> <span class="fu">factor</span>(corr_df<span class="sc">$</span>sig, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sig"</span>, <span class="st">"non-sig"</span>))</span>
<span id="cb29-692"><a href="#cb29-692" aria-hidden="true" tabindex="-1"></a>corr_df<span class="sc">$</span>sig_cat <span class="ot">&lt;-</span> <span class="fu">factor</span>(corr_df<span class="sc">$</span>sig_cat, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Lower"</span>, <span class="st">"Neutral"</span>, <span class="st">"Higher"</span>))</span>
<span id="cb29-693"><a href="#cb29-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-694"><a href="#cb29-694" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust the x- and y-axis scales using ggplot: c(0, 15)</span></span>
<span id="cb29-695"><a href="#cb29-695" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("scales")</span></span>
<span id="cb29-696"><a href="#cb29-696" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggplot2")</span></span>
<span id="cb29-697"><a href="#cb29-697" aria-hidden="true" tabindex="-1"></a>scales_x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Central_America =</span> <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">5</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">5</span>)))</span>
<span id="cb29-698"><a href="#cb29-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-699"><a href="#cb29-699" aria-hidden="true" tabindex="-1"></a>scales_y <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SPCC =</span> <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)))</span>
<span id="cb29-700"><a href="#cb29-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-701"><a href="#cb29-701" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(corr_df)</span>
<span id="cb29-702"><a href="#cb29-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-703"><a href="#cb29-703" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the spatial autocorrelogram using ggplot</span></span>
<span id="cb29-704"><a href="#cb29-704" aria-hidden="true" tabindex="-1"></a><span class="co"># jpeg("Spatial_auto100km.tiff", units="in", width=10, height=10, res=300) this never works</span></span>
<span id="cb29-705"><a href="#cb29-705" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(corr_df, <span class="fu">aes</span>(<span class="at">x =</span> distance, <span class="at">y =</span> corr)) <span class="sc">+</span></span>
<span id="cb29-706"><a href="#cb29-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb29-707"><a href="#cb29-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> sig_cat, <span class="at">fill =</span> sig_cat), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb29-708"><a href="#cb29-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">alpha</span>(<span class="st">"darkblue"</span>, <span class="fl">0.6</span>), <span class="fu">gray.colors</span>(<span class="dv">12</span>)[<span class="dv">6</span>], <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb29-709"><a href="#cb29-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">alpha</span>(<span class="st">"darkblue"</span>, <span class="fl">0.6</span>), <span class="fu">gray.colors</span>(<span class="dv">12</span>)[<span class="dv">6</span>], <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb29-710"><a href="#cb29-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb29-711"><a href="#cb29-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb29-712"><a href="#cb29-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb29-713"><a href="#cb29-713" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"black"</span>), </span>
<span id="cb29-714"><a href="#cb29-714" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.35</span>), </span>
<span id="cb29-715"><a href="#cb29-715" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-716"><a href="#cb29-716" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-717"><a href="#cb29-717" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>), </span>
<span id="cb29-718"><a href="#cb29-718" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.15</span>), </span>
<span id="cb29-719"><a href="#cb29-719" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">18</span>), </span>
<span id="cb29-720"><a href="#cb29-720" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">18</span>), </span>
<span id="cb29-721"><a href="#cb29-721" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb29-722"><a href="#cb29-722" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb29-723"><a href="#cb29-723" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>, </span>
<span id="cb29-724"><a href="#cb29-724" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb29-725"><a href="#cb29-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Pairwise Geographic Distance (km)"</span>) <span class="sc">+</span> </span>
<span id="cb29-726"><a href="#cb29-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mantel Spatial Correlation of Acoustic Similarity"</span>) <span class="sc">+</span> </span>
<span id="cb29-727"><a href="#cb29-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Spatial Correlation Values"</span>), <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Spatial Correlation Values"</span>))</span>
<span id="cb29-728"><a href="#cb29-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-729"><a href="#cb29-729" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb29-730"><a href="#cb29-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-731"><a href="#cb29-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-732"><a href="#cb29-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-733"><a href="#cb29-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-734"><a href="#cb29-734" aria-hidden="true" tabindex="-1"></a><span class="in">```{r DEPRECATED 2, eval = FALSE}</span></span>
<span id="cb29-735"><a href="#cb29-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-736"><a href="#cb29-736" aria-hidden="true" tabindex="-1"></a>count_call <span class="ot">&lt;-</span> <span class="fu">table</span>(sels<span class="sc">$</span>Call_Type)</span>
<span id="cb29-737"><a href="#cb29-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-738"><a href="#cb29-738" aria-hidden="true" tabindex="-1"></a>sels <span class="ot">&lt;-</span> sels[<span class="fu">order</span>(<span class="fu">match</span>(sels<span class="sc">$</span>Call_Type, <span class="fu">names</span>(count_call)[<span class="fu">order</span>(count_call)])), ]</span>
<span id="cb29-739"><a href="#cb29-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-740"><a href="#cb29-740" aria-hidden="true" tabindex="-1"></a>combs <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">combn</span>(sels<span class="sc">$</span>selsID, <span class="at">m =</span> <span class="dv">2</span>))</span>
<span id="cb29-741"><a href="#cb29-741" aria-hidden="true" tabindex="-1"></a><span class="co"># combs &lt;- combs[sapply(strsplit(combs[,1], "-"), "[", 1) != sapply(strsplit(combs[,2], "-"), "[", 1), ]</span></span>
<span id="cb29-742"><a href="#cb29-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-743"><a href="#cb29-743" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(combs)</span>
<span id="cb29-744"><a href="#cb29-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-745"><a href="#cb29-745" aria-hidden="true" tabindex="-1"></a>combs <span class="ot">&lt;-</span> combs[<span class="sc">!</span><span class="fu">duplicated</span>(combs[,<span class="dv">2</span>]), ]</span>
<span id="cb29-746"><a href="#cb29-746" aria-hidden="true" tabindex="-1"></a><span class="co"># diff_combs &lt;- diff_combs[!duplicated(diff_combs[,2]), ]</span></span>
<span id="cb29-747"><a href="#cb29-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-748"><a href="#cb29-748" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb29-749"><a href="#cb29-749" aria-hidden="true" tabindex="-1"></a><span class="co"># keep &lt;- TRUE</span></span>
<span id="cb29-750"><a href="#cb29-750" aria-hidden="true" tabindex="-1"></a><span class="co"># for(x in 2:nrow(combs)){</span></span>
<span id="cb29-751"><a href="#cb29-751" aria-hidden="true" tabindex="-1"></a><span class="co">#     prev &lt;- unique(c(combs[seq_len(x - 1), , drop = FALSE][keep, ]))</span></span>
<span id="cb29-752"><a href="#cb29-752" aria-hidden="true" tabindex="-1"></a><span class="co">#        keep[x] &lt;- !any(combs[x, ] %in% prev)</span></span>
<span id="cb29-753"><a href="#cb29-753" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb29-754"><a href="#cb29-754" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb29-755"><a href="#cb29-755" aria-hidden="true" tabindex="-1"></a><span class="co"># combs &lt;- combs[keep, ]</span></span>
<span id="cb29-756"><a href="#cb29-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-757"><a href="#cb29-757" aria-hidden="true" tabindex="-1"></a>combs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(combs)</span>
<span id="cb29-758"><a href="#cb29-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-759"><a href="#cb29-759" aria-hidden="true" tabindex="-1"></a>geo_dists <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/pairwise_distances.RDS"</span>)</span>
<span id="cb29-760"><a href="#cb29-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-761"><a href="#cb29-761" aria-hidden="true" tabindex="-1"></a>combs<span class="sc">$</span>geo_dist <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(combs), <span class="cf">function</span>(x) {</span>
<span id="cb29-762"><a href="#cb29-762" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-763"><a href="#cb29-763" aria-hidden="true" tabindex="-1"></a>    geo_dists[<span class="fu">rownames</span>(geo_dists) <span class="sc">==</span> combs[x, <span class="dv">1</span>], <span class="fu">colnames</span>(geo_dists) <span class="sc">==</span> combs[x, <span class="dv">2</span>]]</span>
<span id="cb29-764"><a href="#cb29-764" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb29-765"><a href="#cb29-765" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb29-766"><a href="#cb29-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-767"><a href="#cb29-767" aria-hidden="true" tabindex="-1"></a>combs<span class="sc">$</span>call_dist <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(combs), <span class="cf">function</span>(x) {</span>
<span id="cb29-768"><a href="#cb29-768" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-769"><a href="#cb29-769" aria-hidden="true" tabindex="-1"></a>    xc[<span class="fu">rownames</span>(xc) <span class="sc">==</span> combs[x, <span class="dv">1</span>], <span class="fu">colnames</span>(xc) <span class="sc">==</span> combs[x, <span class="dv">2</span>]]</span>
<span id="cb29-770"><a href="#cb29-770" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb29-771"><a href="#cb29-771" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb29-772"><a href="#cb29-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-773"><a href="#cb29-773" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(combs<span class="sc">$</span>call_dist)</span>
<span id="cb29-774"><a href="#cb29-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-775"><a href="#cb29-775" aria-hidden="true" tabindex="-1"></a>combs<span class="sc">$</span>call_dist <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> combs<span class="sc">$</span>call_dist</span>
<span id="cb29-776"><a href="#cb29-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-777"><a href="#cb29-777" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(combs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"call.type1"</span>, <span class="st">"call.type2"</span>, <span class="st">"geo.dist"</span>, <span class="st">"acoustic.dist"</span>)</span>
<span id="cb29-778"><a href="#cb29-778" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-779"><a href="#cb29-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-780"><a href="#cb29-780" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- '&amp;nbsp;' adds blank space --&gt;</span></span>
<span id="cb29-781"><a href="#cb29-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-782"><a href="#cb29-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-783"><a href="#cb29-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-784"><a href="#cb29-784" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- light green box --&gt;</span></span>
<span id="cb29-785"><a href="#cb29-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-786"><a href="#cb29-786" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">class</span><span class="ot">=</span><span class="st">"alert alert-success"</span><span class="kw">&gt;</span></span>
<span id="cb29-787"><a href="#cb29-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-788"><a href="#cb29-788" aria-hidden="true" tabindex="-1"></a><span class="fu"># Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb29-789"><a href="#cb29-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-790"><a href="#cb29-790" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Changes in acoustic similarity largely due to dialects: calls from the same dialect are way more similar</span>
<span id="cb29-791"><a href="#cb29-791" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There is also a small positive effect of geoprahic distance on acoustic similarity: calls further away are slightly more similar</span>
<span id="cb29-792"><a href="#cb29-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-793"><a href="#cb29-793" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span>
<span id="cb29-794"><a href="#cb29-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-795"><a href="#cb29-795" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span></span>
<span id="cb29-796"><a href="#cb29-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-797"><a href="#cb29-797" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- '---' adds a gray vertical line --&gt;</span></span>
<span id="cb29-798"><a href="#cb29-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-799"><a href="#cb29-799" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb29-800"><a href="#cb29-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-801"><a href="#cb29-801" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb29-802"><a href="#cb29-802" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb29-803"><a href="#cb29-803" aria-hidden="true" tabindex="-1"></a><span class="co"> &lt;!-- add packages used, system details and versions  --&gt;</span></span>
<span id="cb29-804"><a href="#cb29-804" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb29-805"><a href="#cb29-805" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session information {.unnumbered .unlisted}</span></span>
<span id="cb29-806"><a href="#cb29-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-807"><a href="#cb29-807" aria-hidden="true" tabindex="-1"></a><span class="in">```{r session info, echo=F}</span></span>
<span id="cb29-808"><a href="#cb29-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-809"><a href="#cb29-809" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb29-810"><a href="#cb29-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-811"><a href="#cb29-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>